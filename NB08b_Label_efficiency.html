<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>NB08b Label efficiency
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="author" content="">
    <link rel="shortcut icon" type="image/x-icon" href="/BIO-BTE-06-L-7//img/favicon.ico">
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <!-- <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script> -->

    <link type="text/css" rel="stylesheet" href="/BIO-BTE-06-L-7/content/fsdocs-default.css" />
    <link type="text/css" rel="stylesheet" href="/BIO-BTE-06-L-7/content/fsdocs-custom.css" />
    <script type="text/javascript" src="/BIO-BTE-06-L-7/content/fsdocs-tips.js"></script>
    
    <link type="text/css" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
    <script defer type="text/javascript" src="https://kit.fontawesome.com/0d3e0ea7a6.js"></script>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!-- BEGIN SEARCH BOX: this adds support for the search box -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/JavaScript-autoComplete/1.0.4/auto-complete.css" />
    <!-- END SEARCH BOX: this adds support for the search box -->
    
</head> 

<body>
    <div class="columns is-fullheight m-0">
        <div id="fsdocs-menu" class="column is-2 is-paddingless">
            <aside class="menu">
                <div class="container is-paddingless is-marginless has-background-dark">
                    <a href="/BIO-BTE-06-L-7/">
                        <figure class="image is-128x128 container">
                            <img src="img/logo.svg">
                        </figure>
                    </a>
                    <h2 class="title has-text-centered has-text-white pb-4">BIO-BTE-06-L-7</h2>
                </div>
                <div class="content">
                    <!-- BEGIN SEARCH BOX: this adds support for the search box -->
                    <div id="header">
                        <div class="field">
                            <div class="control has-icons-left has-icons-right searchbox" id="fsdocs-searchbox">
                                <input data-search-input="" id="search-by" type="search" placeholder="Search..." class="input"/>
                                <span class="icon is-small is-left">
                                    <i class="fas fa-search"></i>
                                </span>
                            </div>
                        </div>
                    </div>

                    <!-- END SEARCH BOX: this adds support for the search box -->
                    <ul class="navbar-nav">
                        <li class="nav-item">
                            <a class="nav-link" href="NB00a_FSharp_Coding_literacy_Part_I.html">
                                <span class="text">
                                    <span>NB00a FSharp Coding literacy part I</span>
                                </span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="NB00b_FSharp_Coding_literacy_Part_II.html">
                                <span class="text">
                                    <span>NB00b FSharp Coding literacy part II</span>
                                </span>
                            </a>
                        </li>
                        <!--<li class="nav-item">
                            <a class="nav-link" href="NB01a_Systems_Biology_FSharp_Introduction.html">
                                <span class="text">
                                    <span>NB01a Systems Biology</span>
                                </span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="NB01b_Plant_Systems_Biology.html">
                                <span class="text">
                                    <span>NB01b Plant Systems Biology</span>
                                </span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="NB02a_Mass_spectrometry_based_proteomics.html">
                                <span class="text">
                                    <span>NB02a Mass Spectrometry Based Proteomics</span>
                                </span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="NB02b_Digestion_and_mass_calculation.html">
                                <span class="text">
                                    <span>NB02b Digestion and mass calculation</span>
                                </span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="NB02c_Isotopic_distribution.html">
                                <span class="text">
                                    <span>NB02c Isotopic Distribution</span>
                                </span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="NB03a_Retention_time_and_scan_time.html">
                                <span class="text">
                                    <span>NB03a Retention time and scan time</span>
                                </span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="NB03b_Signal_detection_and_quantification.html">
                                <span class="text">
                                    <span>NB03b Signal detection and quantification</span>
                                </span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="NB03c_Centroidisation.html">
                                <span class="text">
                                    <span>NB03c Centroidisation</span>
                                </span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="NB04a_Fragmentation_for_peptide_identification.html">
                                <span class="text">
                                    <span>NB04a Fragmentation for peptide identification</span>
                                </span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="NB04b_Peptide_Identification.html">
                                <span class="text">
                                    <span>NB04b Peptide Identification</span>
                                </span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="NB05a_Quantification.html">
                                <span class="text">
                                    <span>NB05a Quantification</span>
                                </span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="NB06a_Research_Data_Management.html">
                                <span class="text">
                                    <span>NB06a Research Data Management</span>
                                </span>
                            </a>
                        </li>-->
                        <li class="nav-item">
                            <a class="nav-link" href="NB07a_Working_With_Deedle.html">
                                <span class="text">
                                    <span>NB07a Working with Deedle</span>
                                </span>
                            </a>
                        </li>
                        <!--<li class="nav-item">
                            <a class="nav-link" href="NB08a_Data_Access_And_Quality_Control.html">
                                <span class="text">
                                    <span>NB08a Data Access and Quality Control</span>
                                </span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="NB08a_Data_Access_And_Quality_Control_SDS.html">
                                <span class="text">
                                    <span>NB08a Data Access and Quality Control (SDS)</span>
                                </span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="NB08a_Data_Access_And_Quality_Control_BN.html">
                                <span class="text">
                                    <span>NB08a Data Access and Quality Control (BN)</span>
                                </span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="NB08b_Label_efficiency.html">
                                <span class="text">
                                    <span>NB08b Label Efficiency</span>
                                </span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="NB08b_Label_efficiency_SDS.html">
                                <span class="text">
                                    <span>NB08b Label Efficiency (SDS)</span>
                                </span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="NB08b_Label_efficiency_BN.html">
                                <span class="text">
                                    <span>NB08b Label Efficiency (BN)</span>
                                </span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="NB08c_Absolute_Quantification.html">
                                <span class="text">
                                    <span>NB08c Absolute Quantification</span>
                                </span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="NB08c_Absolute_Quantification_SDS.html">
                                <span class="text">
                                    <span>NB08c Absolute Quantification (SDS)</span>
                                </span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="NB08c_Absolute_Quantification_BN.html">
                                <span class="text">
                                    <span>NB08c Absolute Quantification (BN)</span>
                                </span>
                            </a>
                        </li>-->
                        <li class="nav-header">Links</li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://csb.bio.uni-kl.de/#teaching">
                                <span class="icon-text">
                                    <span class="icon">
                                        <i class="fas fa-graduation-cap"></i>
                                    </span>
                                    <span>Other CSB courses</span>
                                </span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://twitter.com/cs_biology">
                                <span class="icon-text">
                                    <span class="icon">
                                        <i class="fab fa-twitter"></i>
                                    </span>
                                    <span>Get in touch on twitter</span>
                                </span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://github.com/CSBiology?type=source">
                                <span class="icon-text">
                                    <span class="icon">
                                        <i class="fab fa-github"></i>
                                    </span>
                                    <span>Check out our open source projects</span>
                                </span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://github.com/CSBiology/BIO-BTE-06-L-7">
                                <span class="icon-text">
                                    <span class="icon">
                                        <i class="fas fa-code-branch"></i>
                                    </span>
                                    <span>Source repository</span>
                                </span>
                            </a>
                        </li>
                    </ul>
                </div>
            </aside>
        </div>
        <div class="column is-10 is-paddingless has-text-justified	">
            <div class="section pt-4">
                <div class="container" id="fsdocs-content">
                    <pre class="fssnip highlighted"><code lang="fsharp"><span class="m">#r</span> <span class="s">&quot;nuget: FSharp.Stats, 0.4.3&quot;</span>
<span class="pp">#r</span> <span class="s">&quot;nuget: BioFSharp, 2.0.0-beta5&quot;</span>
<span class="pp">#r</span> <span class="s">&quot;nuget: BioFSharp.IO, 2.0.0-beta5&quot;</span>
<span class="pp">#r</span> <span class="s">&quot;nuget: Plotly.NET, 2.0.0-preview.16&quot;</span>
<span class="pp">#r</span> <span class="s">&quot;nuget: Deedle, 2.5.0&quot;</span>

<span class="pp">#if</span> <span class="id">IPYNB</span>
<span class="inactive">#r</span><span class="inactive"> </span><span class="inactive">&quot;nuget:</span><span class="inactive"> </span><span class="inactive">Plotly.NET.Interactive,</span><span class="inactive"> </span><span class="inactive">2.0.0-preview.16&quot;</span>
<span class="pp">#endif</span> <span class="c">// IPYNB</span>

<span class="k">open</span> <span class="id">Deedle</span>
<span class="k">open</span> <span class="id">BioFSharp</span>
<span class="k">open</span> <span class="id">FSharpAux</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="id">FSharp</span><span class="pn">.</span><span class="id">Stats</span>
<span class="k">open</span> <span class="id">Plotly</span><span class="pn">.</span><span class="id">NET</span>
</code></pre>
<h1><a name="NB08b-Label-efficiency" class="anchor" href="#NB08b-Label-efficiency">NB08b Label efficiency</a></h1>
<p><a href="https://mybinder.org/v2/gh/CSBiology/BIO-BTE-06-L-7/gh-pages?filepath=NB08b_Label_efficiency.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt="Binder" /></a></p>
<p><a href="https://github.com/CSBiology/BIO-BTE-06-L-7/releases/download/NB08b/NB08b_Label_efficiency.ipynb">Download Notebook</a></p>
<p>Stable isotopic peptide labeling is the foundation of QconCAT experiments. While an excellent tool when carried out with correctly, it also exposes
challenges and pitfalls that have to be checked and possibly accounted for. One of these pitfalls is the efficiency with which we labeled
our QconCAT protein (Why?). In this notebook we will have a look at some high quality peptides selected in the previous notebook and
illustrate how the label efficiency can be calculated using simulations.</p>
<h2><a name="I-Reading-the-data" class="anchor" href="#I-Reading-the-data">I. Reading the data</a></h2>
<p>As promised, we start this notebook with the output of the previous analysis, this notebook assumes that the data from <em>NB08a Data Access and Quality Control</em> is stored in a .txt</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">type</span> <span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="rt">Qprot</span> <span class="o">=</span> 
    <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs3', 3)" onmouseover="showTip(event, 'fs3', 3)" class="uc">CBB</span>
    <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs4', 4)" onmouseover="showTip(event, 'fs4', 4)" class="uc">PS</span> 

<span class="k">type</span> <span onmouseout="hideTip(event, 'fs5', 5)" onmouseover="showTip(event, 'fs5', 5)" class="rt">PeptideIon</span> <span class="o">=</span> 
    <span class="pn">{|</span>
        <span class="prop">ProteinGroup</span>    <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs6', 6)" onmouseover="showTip(event, 'fs6', 6)" class="rt">string</span>  
        <span class="prop">Synonyms</span>        <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs6', 7)" onmouseover="showTip(event, 'fs6', 7)" class="rt">string</span>
        <span class="prop">StringSequence</span>  <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs6', 8)" onmouseover="showTip(event, 'fs6', 8)" class="rt">string</span>
        <span class="prop">PepSequenceID</span>   <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs7', 9)" onmouseover="showTip(event, 'fs7', 9)" class="vt">int</span>
        <span class="prop">Charge</span>          <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs7', 10)" onmouseover="showTip(event, 'fs7', 10)" class="vt">int</span>
        <span class="prop">QProt</span>           <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs2', 11)" onmouseover="showTip(event, 'fs2', 11)" class="rt">Qprot</span>
    <span class="pn">|}</span>

<span class="c">//This is the filepath you chose in *NB08a Data Access and Quality Control*</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs8', 12)" onmouseover="showTip(event, 'fs8', 12)" class="id">filePath</span> <span class="o">=</span> <span class="s">@&quot;C:\YourPath\testOut.txt&quot;</span>

<span class="c">// What is different about this function from the one known from the last notebook?</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs9', 13)" onmouseover="showTip(event, 'fs9', 13)" class="id">qConcatDataFiltered</span> <span class="o">=</span>
    <span class="id">Frame</span><span class="pn">.</span><span class="id">ReadCsv</span><span class="pn">(</span><span class="id">path</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs8', 14)" onmouseover="showTip(event, 'fs8', 14)" class="id">filePath</span><span class="pn">,</span><span class="id">separators</span><span class="o">=</span><span class="s">&quot;\t&quot;</span><span class="pn">)</span>
    <span class="c">// StringSequence is the peptide sequence</span>
    <span class="o">|&gt;</span> <span class="id">Frame</span><span class="pn">.</span><span class="id">indexRowsUsing</span> <span class="pn">(</span><span class="k">fun</span> <span class="id">os</span> <span class="k">-&gt;</span> 
            <span class="k">let</span> <span class="id">proteinGroup</span> <span class="o">=</span> <span class="id">os</span><span class="pn">.</span><span class="id">GetAs</span><span class="pn">&lt;</span><span onmouseout="hideTip(event, 'fs6', 15)" onmouseover="showTip(event, 'fs6', 15)" class="id">string</span><span class="pn">&gt;</span><span class="pn">(</span><span class="s">&quot;ProteinGroup&quot;</span><span class="pn">)</span>
            <span class="k">let</span> <span class="id">qprot</span> <span class="o">=</span> 
                <span class="k">match</span> <span class="id">proteinGroup</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs10', 16)" onmouseover="showTip(event, 'fs10', 16)" class="id">String</span><span class="pn">.</span><span class="id">contains</span> <span class="s">&quot;QProt_newCBB&quot;</span><span class="pn">,</span> <span class="id">proteinGroup</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs10', 17)" onmouseover="showTip(event, 'fs10', 17)" class="id">String</span><span class="pn">.</span><span class="id">contains</span> <span class="s">&quot;QProt_newPS&quot;</span> <span class="k">with</span> 
                <span class="pn">|</span> <span class="k">true</span><span class="pn">,</span> <span class="k">false</span>  <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs11', 18)" onmouseover="showTip(event, 'fs11', 18)" class="id">Some</span> <span onmouseout="hideTip(event, 'fs3', 19)" onmouseover="showTip(event, 'fs3', 19)" class="id">CBB</span>
                <span class="pn">|</span> <span class="k">false</span><span class="pn">,</span> <span class="k">true</span>  <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs11', 20)" onmouseover="showTip(event, 'fs11', 20)" class="id">Some</span> <span onmouseout="hideTip(event, 'fs4', 21)" onmouseover="showTip(event, 'fs4', 21)" class="id">PS</span> 
                <span class="pn">|</span> <span class="id">_</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs12', 22)" onmouseover="showTip(event, 'fs12', 22)" class="id">None</span>  
            <span class="pn">{|</span>
                <span class="id">ProteinGroup</span>    <span class="o">=</span> <span class="id">os</span><span class="pn">.</span><span class="id">GetAs</span><span class="pn">&lt;</span><span onmouseout="hideTip(event, 'fs6', 23)" onmouseover="showTip(event, 'fs6', 23)" class="id">string</span><span class="pn">&gt;</span><span class="pn">(</span><span class="s">&quot;ProteinGroup&quot;</span><span class="pn">)</span><span class="pn">;</span> 
                <span class="id">Synonyms</span>        <span class="o">=</span> <span class="id">os</span><span class="pn">.</span><span class="id">GetAs</span><span class="pn">&lt;</span><span onmouseout="hideTip(event, 'fs6', 24)" onmouseover="showTip(event, 'fs6', 24)" class="id">string</span><span class="pn">&gt;</span><span class="pn">(</span><span class="s">&quot;Synonym&quot;</span><span class="pn">)</span>
                <span class="id">StringSequence</span>  <span class="o">=</span> <span class="id">os</span><span class="pn">.</span><span class="id">GetAs</span><span class="pn">&lt;</span><span onmouseout="hideTip(event, 'fs6', 25)" onmouseover="showTip(event, 'fs6', 25)" class="id">string</span><span class="pn">&gt;</span><span class="pn">(</span><span class="s">&quot;StringSequence&quot;</span><span class="pn">)</span><span class="pn">;</span>
                <span class="id">PepSequenceID</span>   <span class="o">=</span> <span class="id">os</span><span class="pn">.</span><span class="id">GetAs</span><span class="pn">&lt;</span><span onmouseout="hideTip(event, 'fs7', 26)" onmouseover="showTip(event, 'fs7', 26)" class="id">int</span><span class="pn">&gt;</span><span class="pn">(</span><span class="s">&quot;PepSequenceID&quot;</span><span class="pn">)</span><span class="pn">;</span>
                <span class="id">Charge</span>          <span class="o">=</span> <span class="id">os</span><span class="pn">.</span><span class="id">GetAs</span><span class="pn">&lt;</span><span onmouseout="hideTip(event, 'fs7', 27)" onmouseover="showTip(event, 'fs7', 27)" class="id">int</span><span class="pn">&gt;</span><span class="pn">(</span><span class="s">&quot;Charge&quot;</span><span class="pn">)</span><span class="pn">;</span>
                <span class="id">QProt</span>           <span class="o">=</span> <span class="id">qprot</span><span class="pn">;</span>
            <span class="pn">|}</span>
        <span class="pn">)</span>
    <span class="o">|&gt;</span> <span class="id">Frame</span><span class="pn">.</span><span class="id">filterRows</span> <span class="pn">(</span><span class="k">fun</span> <span class="id">k</span> <span class="id">s</span> <span class="k">-&gt;</span> <span class="id">k</span><span class="pn">.</span><span class="id">QProt</span><span class="pn">.</span><span class="id">IsSome</span><span class="pn">)</span>
    <span class="o">|&gt;</span> <span class="id">Frame</span><span class="pn">.</span><span class="id">mapRowKeys</span> <span class="pn">(</span><span class="k">fun</span> <span class="id">k</span> <span class="k">-&gt;</span> <span class="pn">{|</span><span class="id">k</span> <span class="k">with</span> <span class="id">QProt</span> <span class="o">=</span> <span class="id">k</span><span class="pn">.</span><span class="id">QProt</span><span class="pn">.</span><span class="id">Value</span><span class="pn">|}</span><span class="pn">)</span>

<span onmouseout="hideTip(event, 'fs9', 28)" onmouseover="showTip(event, 'fs9', 28)" class="id">qConcatDataFiltered</span><span class="pn">.</span><span class="id">ColumnKeys</span>
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs13', 29)" onmouseover="showTip(event, 'fs13', 29)" class="m">Array</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs14', 30)" onmouseover="showTip(event, 'fs14', 30)" class="id">ofSeq</span>
</code></pre>
<table class="pre"><tr><td><pre><code>No value returned by any evaluator</code></pre></td></tr></table>
<p>First we reuse a proved pattern and define a function to manipulate our frame</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs15', 31)" onmouseover="showTip(event, 'fs15', 31)" class="fn">sliceQuantColumns</span> <span onmouseout="hideTip(event, 'fs16', 32)" onmouseover="showTip(event, 'fs16', 32)" class="fn">quantColID</span> <span onmouseout="hideTip(event, 'fs17', 33)" onmouseover="showTip(event, 'fs17', 33)" class="fn">frame</span> <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs17', 34)" onmouseover="showTip(event, 'fs17', 34)" class="fn">frame</span>
    <span class="o">|&gt;</span> <span class="id">Frame</span><span class="pn">.</span><span class="id">filterCols</span> <span class="pn">(</span><span class="k">fun</span> <span class="id">ck</span> <span class="id">os</span> <span class="k">-&gt;</span> <span class="id">ck</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs10', 35)" onmouseover="showTip(event, 'fs10', 35)" class="id">String</span><span class="pn">.</span><span class="id">contains</span> <span class="pn">(</span><span class="s">&quot;.&quot;</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs16', 36)" onmouseover="showTip(event, 'fs16', 36)" class="id">quantColID</span><span class="pn">)</span><span class="pn">)</span>
    <span class="o">|&gt;</span> <span class="id">Frame</span><span class="pn">.</span><span class="id">mapColKeys</span> <span class="pn">(</span><span class="k">fun</span> <span class="id">ck</span> <span class="k">-&gt;</span> <span class="id">ck</span><span class="pn">.</span><span class="id">Split</span><span class="pn">(</span><span class="s">&#39;.&#39;</span><span class="pn">)</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs13', 37)" onmouseover="showTip(event, 'fs13', 37)" class="id">Array</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs18', 38)" onmouseover="showTip(event, 'fs18', 38)" class="id">item</span> <span class="n">0</span><span class="pn">)</span>
</code></pre>
<p>Besides already familiar slices...</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs19', 39)" onmouseover="showTip(event, 'fs19', 39)" class="id">heavy</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs15', 40)" onmouseover="showTip(event, 'fs15', 40)" class="fn">sliceQuantColumns</span> <span class="s">&quot;Quant_Heavy&quot;</span> <span onmouseout="hideTip(event, 'fs9', 41)" onmouseover="showTip(event, 'fs9', 41)" class="id">qConcatDataFiltered</span>
</code></pre>
<p>... we can also use this function for information needed to reconstruct isotopic patterns.</p>
<h2><a name="II-Extraction-and-visualization-of-measured-isotopic-envelopes" class="anchor" href="#II-Extraction-and-visualization-of-measured-isotopic-envelopes">II. Extraction and visualization of measured isotopic envelopes.</a></h2>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs20', 42)" onmouseover="showTip(event, 'fs20', 42)" class="id">heavyPatternMz</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs15', 43)" onmouseover="showTip(event, 'fs15', 43)" class="fn">sliceQuantColumns</span> <span class="s">&quot;heavyPatternMz&quot;</span> <span onmouseout="hideTip(event, 'fs9', 44)" onmouseover="showTip(event, 'fs9', 44)" class="id">qConcatDataFiltered</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs21', 45)" onmouseover="showTip(event, 'fs21', 45)" class="id">heavyPatternI</span>  <span class="o">=</span> <span onmouseout="hideTip(event, 'fs15', 46)" onmouseover="showTip(event, 'fs15', 46)" class="fn">sliceQuantColumns</span> <span class="s">&quot;heavyPatternI&quot;</span> <span onmouseout="hideTip(event, 'fs9', 47)" onmouseover="showTip(event, 'fs9', 47)" class="id">qConcatDataFiltered</span>
</code></pre>
<p>Now, there's a challenge: The info to reconstruct an isotopic pattern is
separated into two columns, the x component (heavyPatternMz) and the y component (heavyPatternI).
As always, this challenged can be solved using a function!
Hint: Note how we define a function 'floatArrayOf' that specifies how the string is parsed.</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs22', 48)" onmouseover="showTip(event, 'fs22', 48)" class="fn">getHeavyPatternsInFile</span> <span onmouseout="hideTip(event, 'fs23', 49)" onmouseover="showTip(event, 'fs23', 49)" class="fn">fileName</span> <span class="o">=</span> 
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs24', 50)" onmouseover="showTip(event, 'fs24', 50)" class="fn">floatArrayOf</span> <span onmouseout="hideTip(event, 'fs25', 51)" onmouseover="showTip(event, 'fs25', 51)" class="fn">s</span> <span class="o">=</span> 
        <span class="k">if</span> <span onmouseout="hideTip(event, 'fs10', 52)" onmouseover="showTip(event, 'fs10', 52)" class="m">String</span><span class="pn">.</span><span class="id">isNullOrEmpty</span> <span onmouseout="hideTip(event, 'fs25', 53)" onmouseover="showTip(event, 'fs25', 53)" class="id">s</span> <span class="k">then</span> 
            <span class="pn">[|</span><span class="pn">|]</span>
        <span class="k">else</span>
            <span onmouseout="hideTip(event, 'fs25', 54)" onmouseover="showTip(event, 'fs25', 54)" class="fn">s</span>
            <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs10', 55)" onmouseover="showTip(event, 'fs10', 55)" class="m">String</span><span class="pn">.</span><span class="id">split</span> <span class="pn">(</span><span class="s">&#39;;&#39;</span><span class="pn">)</span> 
            <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs13', 56)" onmouseover="showTip(event, 'fs13', 56)" class="m">Array</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs26', 57)" onmouseover="showTip(event, 'fs26', 57)" class="id">map</span> <span onmouseout="hideTip(event, 'fs27', 58)" onmouseover="showTip(event, 'fs27', 58)" class="fn">float</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs28', 59)" onmouseover="showTip(event, 'fs28', 59)" class="fn">mz</span> <span class="o">=</span> 
        <span onmouseout="hideTip(event, 'fs20', 60)" onmouseover="showTip(event, 'fs20', 60)" class="id">heavyPatternMz</span> 
        <span class="o">|&gt;</span> <span class="id">Frame</span><span class="pn">.</span><span class="id">getCol</span> <span onmouseout="hideTip(event, 'fs23', 61)" onmouseover="showTip(event, 'fs23', 61)" class="id">fileName</span> 
        <span class="o">|&gt;</span> <span class="id">Series</span><span class="pn">.</span><span class="id">mapValues</span> <span onmouseout="hideTip(event, 'fs24', 62)" onmouseover="showTip(event, 'fs24', 62)" class="id">floatArrayOf</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs29', 63)" onmouseover="showTip(event, 'fs29', 63)" class="fn">intensities</span> <span class="o">=</span> 
        <span onmouseout="hideTip(event, 'fs21', 64)" onmouseover="showTip(event, 'fs21', 64)" class="id">heavyPatternI</span> 
        <span class="o">|&gt;</span> <span class="id">Frame</span><span class="pn">.</span><span class="id">getCol</span> <span onmouseout="hideTip(event, 'fs23', 65)" onmouseover="showTip(event, 'fs23', 65)" class="id">fileName</span> 
        <span class="o">|&gt;</span> <span class="id">Series</span><span class="pn">.</span><span class="id">mapValues</span> <span onmouseout="hideTip(event, 'fs24', 66)" onmouseover="showTip(event, 'fs24', 66)" class="id">floatArrayOf</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs30', 67)" onmouseover="showTip(event, 'fs30', 67)" class="fn">zipped</span> <span class="o">=</span> <span class="id">Series</span><span class="pn">.</span><span class="id">zipInner</span> <span onmouseout="hideTip(event, 'fs28', 68)" onmouseover="showTip(event, 'fs28', 68)" class="id">mz</span> <span onmouseout="hideTip(event, 'fs29', 69)" onmouseover="showTip(event, 'fs29', 69)" class="id">intensities</span>
    <span onmouseout="hideTip(event, 'fs30', 70)" onmouseover="showTip(event, 'fs30', 70)" class="fn">zipped</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs31', 71)" onmouseover="showTip(event, 'fs31', 71)" class="id">extractedPatterns</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs22', 72)" onmouseover="showTip(event, 'fs22', 72)" class="fn">getHeavyPatternsInFile</span> <span class="s">&quot;WCGr1_U1&quot;</span>
</code></pre>
<table class="pre"><tr><td><pre><code>No value returned by any evaluator</code></pre></td></tr></table>
<p>Additionally, we can write two functions to plot the patterns of a peptide. When it comes
to the build the chart (plotIsotopicPattern), things get a little bit trickier, but this is not necessarily your concern. Please inspect the Chart
created by 'plotIsotopicPatternOf' and write correct descriptions for the x and the y axis. (Fill: |&gt; Chart.withXAxisStyle "" and |&gt; Chart.withYAxisStyle "")</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs32', 73)" onmouseover="showTip(event, 'fs32', 73)" class="fn">plotIsotopicPattern</span> <span onmouseout="hideTip(event, 'fs33', 74)" onmouseover="showTip(event, 'fs33', 74)" class="fn">color</span> <span onmouseout="hideTip(event, 'fs34', 75)" onmouseover="showTip(event, 'fs34', 75)" class="fn">mzsAndintensities</span> <span class="o">=</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs35', 76)" onmouseover="showTip(event, 'fs35', 76)" class="fn">min</span><span class="pn">,</span><span onmouseout="hideTip(event, 'fs36', 77)" onmouseover="showTip(event, 'fs36', 77)" class="fn">max</span> <span class="o">=</span>
        <span onmouseout="hideTip(event, 'fs34', 78)" onmouseover="showTip(event, 'fs34', 78)" class="fn">mzsAndintensities</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs37', 79)" onmouseover="showTip(event, 'fs37', 79)" class="m">Seq</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs38', 80)" onmouseover="showTip(event, 'fs38', 80)" class="id">minBy</span> <span onmouseout="hideTip(event, 'fs39', 81)" onmouseover="showTip(event, 'fs39', 81)" class="fn">fst</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs39', 82)" onmouseover="showTip(event, 'fs39', 82)" class="fn">fst</span><span class="pn">,</span>
        <span onmouseout="hideTip(event, 'fs34', 83)" onmouseover="showTip(event, 'fs34', 83)" class="fn">mzsAndintensities</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs37', 84)" onmouseover="showTip(event, 'fs37', 84)" class="m">Seq</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs40', 85)" onmouseover="showTip(event, 'fs40', 85)" class="id">maxBy</span> <span onmouseout="hideTip(event, 'fs39', 86)" onmouseover="showTip(event, 'fs39', 86)" class="fn">fst</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs39', 87)" onmouseover="showTip(event, 'fs39', 87)" class="fn">fst</span>
    <span onmouseout="hideTip(event, 'fs37', 88)" onmouseover="showTip(event, 'fs37', 88)" class="m">Seq</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs41', 89)" onmouseover="showTip(event, 'fs41', 89)" class="id">map</span> <span class="pn">(</span><span class="k">fun</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs42', 90)" onmouseover="showTip(event, 'fs42', 90)" class="fn">x</span><span class="pn">,</span><span onmouseout="hideTip(event, 'fs43', 91)" onmouseover="showTip(event, 'fs43', 91)" class="fn">y</span><span class="pn">)</span> <span class="k">-&gt;</span> 
        <span class="id">Chart</span><span class="pn">.</span><span class="id">Line</span><span class="pn">(</span><span class="pn">[</span><span onmouseout="hideTip(event, 'fs42', 92)" onmouseover="showTip(event, 'fs42', 92)" class="id">x</span><span class="pn">;</span><span onmouseout="hideTip(event, 'fs42', 93)" onmouseover="showTip(event, 'fs42', 93)" class="id">x</span><span class="pn">]</span><span class="pn">,</span><span class="pn">[</span><span class="n">0.</span><span class="pn">;</span><span onmouseout="hideTip(event, 'fs43', 94)" onmouseover="showTip(event, 'fs43', 94)" class="id">y</span><span class="pn">]</span><span class="pn">,</span> <span class="id">ShowLegend</span> <span class="o">=</span> <span class="k">false</span><span class="pn">)</span>
        <span class="o">|&gt;</span> <span class="id">Chart</span><span class="pn">.</span><span class="id">withLineStyle</span> <span class="pn">(</span><span class="id">Width</span> <span class="o">=</span> <span class="n">7.</span><span class="pn">)</span>
    <span class="pn">)</span> <span onmouseout="hideTip(event, 'fs34', 95)" onmouseover="showTip(event, 'fs34', 95)" class="fn">mzsAndintensities</span>
    <span class="o">|&gt;</span> <span class="id">Chart</span><span class="pn">.</span><span class="id">combine</span>
    <span class="o">|&gt;</span> <span class="id">Chart</span><span class="pn">.</span><span class="id">withMarkerStyle</span><span class="pn">(</span><span class="id">Size</span><span class="o">=</span><span class="n">0</span><span class="pn">,</span><span class="id">Color</span> <span class="o">=</span> <span class="id">Color</span><span class="pn">.</span><span class="id">fromHex</span> <span class="pn">(</span><span class="id">FSharpAux</span><span class="pn">.</span><span class="id">Colors</span><span class="pn">.</span><span class="id">toWebColor</span> <span onmouseout="hideTip(event, 'fs33', 96)" onmouseover="showTip(event, 'fs33', 96)" class="id">color</span><span class="pn">)</span><span class="pn">)</span>
    <span class="o">|&gt;</span> <span class="id">Chart</span><span class="pn">.</span><span class="id">withXAxisStyle</span> <span class="pn">(</span><span class="s">&quot;&quot;</span><span class="pn">,</span> <span class="id">MinMax</span> <span class="o">=</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs35', 97)" onmouseover="showTip(event, 'fs35', 97)" class="id">min</span> <span class="o">-</span> <span class="n">1.</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs36', 98)" onmouseover="showTip(event, 'fs36', 98)" class="id">max</span> <span class="o">+</span> <span class="n">1.</span><span class="pn">)</span><span class="pn">)</span>
    <span class="o">|&gt;</span> <span class="id">Chart</span><span class="pn">.</span><span class="id">withYAxisStyle</span> <span class="s">&quot;&quot;</span>

<span class="k">type</span> <span onmouseout="hideTip(event, 'fs44', 99)" onmouseover="showTip(event, 'fs44', 99)" class="rt">ExtractedIsoPattern</span> <span class="o">=</span> 
    <span class="pn">{|</span>
        <span class="prop">PeptideSequence</span> <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs5', 100)" onmouseover="showTip(event, 'fs5', 100)" class="rt">PeptideIon</span>
        <span class="prop">Charge</span>          <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs7', 101)" onmouseover="showTip(event, 'fs7', 101)" class="vt">int</span>
        <span class="prop">Pattern</span>         <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs45', 102)" onmouseover="showTip(event, 'fs45', 102)" class="if">seq</span><span class="pn">&lt;</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs27', 103)" onmouseover="showTip(event, 'fs27', 103)" class="vt">float</span><span class="pn">*</span><span onmouseout="hideTip(event, 'fs27', 104)" onmouseover="showTip(event, 'fs27', 104)" class="vt">float</span><span class="pn">)</span><span class="pn">&gt;</span>
    <span class="pn">|}</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs46', 105)" onmouseover="showTip(event, 'fs46', 105)" class="fn">getIsotopicPattern</span> <span onmouseout="hideTip(event, 'fs47', 106)" onmouseover="showTip(event, 'fs47', 106)" class="fn">peptideSequence</span> <span onmouseout="hideTip(event, 'fs48', 107)" onmouseover="showTip(event, 'fs48', 107)" class="fn">charge</span> <span class="o">=</span>
    <span class="k">let</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs49', 108)" onmouseover="showTip(event, 'fs49', 108)" class="fn">k</span><span class="pn">,</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs50', 109)" onmouseover="showTip(event, 'fs50', 109)" class="fn">mzs</span><span class="pn">,</span><span onmouseout="hideTip(event, 'fs51', 110)" onmouseover="showTip(event, 'fs51', 110)" class="fn">intensities</span><span class="pn">)</span><span class="pn">)</span> <span class="o">=</span> 
        <span onmouseout="hideTip(event, 'fs31', 111)" onmouseover="showTip(event, 'fs31', 111)" class="id">extractedPatterns</span>
        <span class="o">|&gt;</span> <span class="id">Series</span><span class="pn">.</span><span class="id">observations</span>
        <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs37', 112)" onmouseover="showTip(event, 'fs37', 112)" class="m">Seq</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs52', 113)" onmouseover="showTip(event, 'fs52', 113)" class="id">find</span> <span class="pn">(</span><span class="k">fun</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs49', 114)" onmouseover="showTip(event, 'fs49', 114)" class="fn">k</span><span class="pn">,</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs50', 115)" onmouseover="showTip(event, 'fs50', 115)" class="id">mzs</span><span class="pn">,</span><span onmouseout="hideTip(event, 'fs51', 116)" onmouseover="showTip(event, 'fs51', 116)" class="fn">intensities</span><span class="pn">)</span><span class="pn">)</span> <span class="k">-&gt;</span> 
                <span onmouseout="hideTip(event, 'fs49', 117)" onmouseover="showTip(event, 'fs49', 117)" class="fn">k</span><span class="pn">.</span><span class="id">StringSequence</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs47', 118)" onmouseover="showTip(event, 'fs47', 118)" class="fn">peptideSequence</span> <span class="o">&amp;&amp;</span> <span onmouseout="hideTip(event, 'fs49', 119)" onmouseover="showTip(event, 'fs49', 119)" class="fn">k</span><span class="pn">.</span><span class="id">Charge</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs48', 120)" onmouseover="showTip(event, 'fs48', 120)" class="fn">charge</span>
            <span class="pn">)</span>
    <span class="pn">{|</span>
        <span class="prop">PeptideSequence</span><span class="o">=</span><span onmouseout="hideTip(event, 'fs49', 121)" onmouseover="showTip(event, 'fs49', 121)" class="fn">k</span>
        <span class="prop">Charge</span>  <span class="o">=</span> <span onmouseout="hideTip(event, 'fs48', 122)" onmouseover="showTip(event, 'fs48', 122)" class="fn">charge</span>
        <span class="prop">Pattern</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs37', 123)" onmouseover="showTip(event, 'fs37', 123)" class="m">Seq</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs53', 124)" onmouseover="showTip(event, 'fs53', 124)" class="id">zip</span> <span onmouseout="hideTip(event, 'fs50', 125)" onmouseover="showTip(event, 'fs50', 125)" class="fn">mzs</span> <span onmouseout="hideTip(event, 'fs51', 126)" onmouseover="showTip(event, 'fs51', 126)" class="fn">intensities</span>
    <span class="pn">|}</span>
</code></pre>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs54', 127)" onmouseover="showTip(event, 'fs54', 127)" class="id">examplePep1</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs46', 128)" onmouseover="showTip(event, 'fs46', 128)" class="fn">getIsotopicPattern</span> <span class="s">&quot;DTDILAAFR&quot;</span> <span class="n">2</span>

<span onmouseout="hideTip(event, 'fs32', 129)" onmouseover="showTip(event, 'fs32', 129)" class="fn">plotIsotopicPattern</span> <span class="id">FSharpAux</span><span class="pn">.</span><span class="id">Colors</span><span class="pn">.</span><span class="id">Table</span><span class="pn">.</span><span class="id">Office</span><span class="pn">.</span><span class="id">blue</span> <span onmouseout="hideTip(event, 'fs54', 130)" onmouseover="showTip(event, 'fs54', 130)" class="id">examplePep1</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs55', 131)" onmouseover="showTip(event, 'fs55', 131)" class="id">Pattern</span>
</code></pre>
<table class="pre"><tr><td><pre><code>No value returned by any evaluator</code></pre></td></tr></table>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs56', 135)" onmouseover="showTip(event, 'fs56', 135)" class="id">examplePep2</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs46', 136)" onmouseover="showTip(event, 'fs46', 136)" class="fn">getIsotopicPattern</span> <span class="s">&quot;LTYYTPDYVVR&quot;</span> <span class="n">2</span>

<span onmouseout="hideTip(event, 'fs32', 137)" onmouseover="showTip(event, 'fs32', 137)" class="fn">plotIsotopicPattern</span> <span class="id">FSharpAux</span><span class="pn">.</span><span class="id">Colors</span><span class="pn">.</span><span class="id">Table</span><span class="pn">.</span><span class="id">Office</span><span class="pn">.</span><span class="id">blue</span> <span onmouseout="hideTip(event, 'fs56', 138)" onmouseover="showTip(event, 'fs56', 138)" class="id">examplePep2</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs55', 139)" onmouseover="showTip(event, 'fs55', 139)" class="id">Pattern</span>
</code></pre>
<table class="pre"><tr><td><pre><code>No value returned by any evaluator</code></pre></td></tr></table>
<h2><a name="III-Simulation-of-isotopic-patterns-revisited" class="anchor" href="#III-Simulation-of-isotopic-patterns-revisited">III. Simulation of isotopic patterns: revisited.</a></h2>
<p>Now that we visualized the patterns of two sample peptides, we will simulate theoretical patterns
and compare them to the ones we measured! You will recognize a lot of the used code from <em>NB02c Isotopic distribution</em>
Note: We copy the code so you can make yourself familiar with it, of course we could also reference functions defined beforehand.</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// create chemical formula for amino acid and add water to reflect hydrolysed state in mass spectrometer</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs57', 143)" onmouseover="showTip(event, 'fs57', 143)" class="fn">toFormula</span> <span onmouseout="hideTip(event, 'fs58', 144)" onmouseover="showTip(event, 'fs58', 144)" class="fn">bioseq</span> <span class="o">=</span>  
    <span onmouseout="hideTip(event, 'fs58', 145)" onmouseover="showTip(event, 'fs58', 145)" class="fn">bioseq</span>
    <span class="o">|&gt;</span> <span class="id">BioSeq</span><span class="pn">.</span><span class="id">toFormula</span>
    <span class="c">// peptides are hydrolysed in the mass spectrometer, so we add H2O</span>
    <span class="o">|&gt;</span> <span class="id">Formula</span><span class="pn">.</span><span class="id">add</span> <span class="id">Formula</span><span class="pn">.</span><span class="id">Table</span><span class="pn">.</span><span class="id">H2O</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs59', 146)" onmouseover="showTip(event, 'fs59', 146)" class="fn">label</span> <span onmouseout="hideTip(event, 'fs60', 147)" onmouseover="showTip(event, 'fs60', 147)" class="fn">n15LableEfficiency</span> <span onmouseout="hideTip(event, 'fs61', 148)" onmouseover="showTip(event, 'fs61', 148)" class="fn">formula</span> <span class="o">=</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs62', 149)" onmouseover="showTip(event, 'fs62', 149)" class="fn">heavyN15</span> <span class="o">=</span> <span class="id">Elements</span><span class="pn">.</span><span class="id">Di</span>  <span class="pn">(</span><span class="id">Elements</span><span class="pn">.</span><span class="id">createDi</span> <span class="s">&quot;N15&quot;</span> <span class="pn">(</span><span class="id">Isotopes</span><span class="pn">.</span><span class="id">Table</span><span class="pn">.</span><span class="id">N15</span><span class="pn">,</span><span onmouseout="hideTip(event, 'fs60', 150)" onmouseover="showTip(event, 'fs60', 150)" class="id">n15LableEfficiency</span><span class="pn">)</span> <span class="pn">(</span><span class="id">Isotopes</span><span class="pn">.</span><span class="id">Table</span><span class="pn">.</span><span class="id">N14</span><span class="pn">,</span><span class="n">1.</span><span class="o">-</span><span onmouseout="hideTip(event, 'fs60', 151)" onmouseover="showTip(event, 'fs60', 151)" class="id">n15LableEfficiency</span><span class="pn">)</span> <span class="pn">)</span>
    <span class="id">Formula</span><span class="pn">.</span><span class="id">replaceElement</span> <span onmouseout="hideTip(event, 'fs61', 152)" onmouseover="showTip(event, 'fs61', 152)" class="id">formula</span> <span class="id">Elements</span><span class="pn">.</span><span class="id">Table</span><span class="pn">.</span><span class="id">N</span> <span onmouseout="hideTip(event, 'fs62', 153)" onmouseover="showTip(event, 'fs62', 153)" class="id">heavyN15</span>

<span class="c">// Predicts an isotopic distribution of the given formula at the given charge, </span>
<span class="c">// normalized by the sum of probabilities, using the MIDAs algorithm</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs63', 154)" onmouseover="showTip(event, 'fs63', 154)" class="fn">generateIsotopicDistribution</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs64', 155)" onmouseover="showTip(event, 'fs64', 155)" class="fn">charge</span><span class="pn">:</span><span onmouseout="hideTip(event, 'fs7', 156)" onmouseover="showTip(event, 'fs7', 156)" class="vt">int</span><span class="pn">)</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs65', 157)" onmouseover="showTip(event, 'fs65', 157)" class="fn">f</span><span class="pn">:</span><span class="id">Formula</span><span class="pn">.</span><span class="id">Formula</span><span class="pn">)</span> <span class="o">=</span>
    <span class="id">IsotopicDistribution</span><span class="pn">.</span><span class="id">MIDA</span><span class="pn">.</span><span class="id">ofFormula</span> 
        <span class="id">IsotopicDistribution</span><span class="pn">.</span><span class="id">MIDA</span><span class="pn">.</span><span class="id">normalizeByProbSum</span>
        <span class="n">0.01</span>
        <span class="n">0.000000001</span>
        <span onmouseout="hideTip(event, 'fs64', 158)" onmouseover="showTip(event, 'fs64', 158)" class="id">charge</span>
        <span onmouseout="hideTip(event, 'fs65', 159)" onmouseover="showTip(event, 'fs65', 159)" class="id">f</span>

<span class="k">type</span> <span onmouseout="hideTip(event, 'fs66', 160)" onmouseover="showTip(event, 'fs66', 160)" class="rt">SimulatedIsoPattern</span> <span class="o">=</span> 
    <span class="pn">{|</span>
        <span class="prop">PeptideSequence</span> <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs6', 161)" onmouseover="showTip(event, 'fs6', 161)" class="rt">string</span>
        <span class="prop">Charge</span>          <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs7', 162)" onmouseover="showTip(event, 'fs7', 162)" class="vt">int</span>
        <span class="prop">LableEfficiency</span> <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs27', 163)" onmouseover="showTip(event, 'fs27', 163)" class="vt">float</span>
        <span class="prop">SimPattern</span>      <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs67', 164)" onmouseover="showTip(event, 'fs67', 164)" class="rt">list</span><span class="pn">&lt;</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs27', 165)" onmouseover="showTip(event, 'fs27', 165)" class="vt">float</span><span class="pn">*</span><span onmouseout="hideTip(event, 'fs27', 166)" onmouseover="showTip(event, 'fs27', 166)" class="vt">float</span><span class="pn">)</span><span class="pn">&gt;</span>
    <span class="pn">|}</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs68', 167)" onmouseover="showTip(event, 'fs68', 167)" class="fn">simulateFrom</span> <span onmouseout="hideTip(event, 'fs69', 168)" onmouseover="showTip(event, 'fs69', 168)" class="fn">peptideSequence</span> <span onmouseout="hideTip(event, 'fs64', 169)" onmouseover="showTip(event, 'fs64', 169)" class="fn">charge</span> <span onmouseout="hideTip(event, 'fs70', 170)" onmouseover="showTip(event, 'fs70', 170)" class="fn">lableEfficiency</span> <span class="o">=</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs71', 171)" onmouseover="showTip(event, 'fs71', 171)" class="fn">simPattern</span> <span class="o">=</span>
        <span onmouseout="hideTip(event, 'fs69', 172)" onmouseover="showTip(event, 'fs69', 172)" class="fn">peptideSequence</span>
        <span class="o">|&gt;</span> <span class="id">BioSeq</span><span class="pn">.</span><span class="id">ofAminoAcidString</span>
        <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs57', 173)" onmouseover="showTip(event, 'fs57', 173)" class="fn">toFormula</span> 
        <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs59', 174)" onmouseover="showTip(event, 'fs59', 174)" class="fn">label</span> <span onmouseout="hideTip(event, 'fs70', 175)" onmouseover="showTip(event, 'fs70', 175)" class="fn">lableEfficiency</span>
        <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs63', 176)" onmouseover="showTip(event, 'fs63', 176)" class="fn">generateIsotopicDistribution</span> <span onmouseout="hideTip(event, 'fs64', 177)" onmouseover="showTip(event, 'fs64', 177)" class="fn">charge</span>     
    <span class="pn">{|</span>
        <span class="prop">PeptideSequence</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs69', 178)" onmouseover="showTip(event, 'fs69', 178)" class="fn">peptideSequence</span>
        <span class="prop">Charge</span>          <span class="o">=</span> <span onmouseout="hideTip(event, 'fs64', 179)" onmouseover="showTip(event, 'fs64', 179)" class="fn">charge</span>
        <span class="prop">LableEfficiency</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs70', 180)" onmouseover="showTip(event, 'fs70', 180)" class="fn">lableEfficiency</span>
        <span class="prop">SimPattern</span>      <span class="o">=</span> <span onmouseout="hideTip(event, 'fs71', 181)" onmouseover="showTip(event, 'fs71', 181)" class="fn">simPattern</span>
    <span class="pn">|}</span>
</code></pre>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs72', 182)" onmouseover="showTip(event, 'fs72', 182)" class="id">examplePep2_Sim1</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs68', 183)" onmouseover="showTip(event, 'fs68', 183)" class="fn">simulateFrom</span> <span class="s">&quot;LTYYTPDYVVR&quot;</span> <span class="n">2</span> <span class="n">0.95</span>

<span onmouseout="hideTip(event, 'fs32', 184)" onmouseover="showTip(event, 'fs32', 184)" class="fn">plotIsotopicPattern</span> <span class="id">FSharpAux</span><span class="pn">.</span><span class="id">Colors</span><span class="pn">.</span><span class="id">Table</span><span class="pn">.</span><span class="id">Office</span><span class="pn">.</span><span class="id">orange</span> <span onmouseout="hideTip(event, 'fs72', 185)" onmouseover="showTip(event, 'fs72', 185)" class="id">examplePep2_Sim1</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs73', 186)" onmouseover="showTip(event, 'fs73', 186)" class="id">SimPattern</span>
</code></pre>
<table class="pre"><tr><td><pre><code>No value returned by any evaluator</code></pre></td></tr></table>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs74', 190)" onmouseover="showTip(event, 'fs74', 190)" class="id">examplePep2_Sim2</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs68', 191)" onmouseover="showTip(event, 'fs68', 191)" class="fn">simulateFrom</span> <span class="s">&quot;LTYYTPDYVVR&quot;</span> <span class="n">2</span> <span class="n">0.99</span>

<span onmouseout="hideTip(event, 'fs32', 192)" onmouseover="showTip(event, 'fs32', 192)" class="fn">plotIsotopicPattern</span> <span class="id">FSharpAux</span><span class="pn">.</span><span class="id">Colors</span><span class="pn">.</span><span class="id">Table</span><span class="pn">.</span><span class="id">Office</span><span class="pn">.</span><span class="id">orange</span> <span onmouseout="hideTip(event, 'fs74', 193)" onmouseover="showTip(event, 'fs74', 193)" class="id">examplePep2_Sim2</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs73', 194)" onmouseover="showTip(event, 'fs73', 194)" class="id">SimPattern</span>
</code></pre>
<table class="pre"><tr><td><pre><code>No value returned by any evaluator</code></pre></td></tr></table>
<h2><a name="IV-Comparing-measured-and-theoretical-isotopic-patterns" class="anchor" href="#IV-Comparing-measured-and-theoretical-isotopic-patterns">IV. Comparing measured and theoretical isotopic patterns.</a></h2>
<p>As we see, there is a discrepancy between real and simulated patterns, both in peak height and in peak count.
But before we compare both patterns, we have to take some things into consideration.
While both patterns are normalized in a way that their intensities
sum to 1., they were normalized independently from each other. Since it is often not possible to
extract all peaks of an isotopic pattern from a MS run (e.g. due to measurement inaccuracies), we have to
write a function which filters the simulated patterns for those peaks present in the experimentally
measured one. Then we normalize it again and have two spectra that can be compared.
// How are distributions called that sum up to 1?</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs75', 198)" onmouseover="showTip(event, 'fs75', 198)" class="fn">normBySum</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs76', 199)" onmouseover="showTip(event, 'fs76', 199)" class="fn">a</span><span class="pn">:</span><span onmouseout="hideTip(event, 'fs45', 200)" onmouseover="showTip(event, 'fs45', 200)" class="if">seq</span><span class="pn">&lt;</span><span onmouseout="hideTip(event, 'fs27', 201)" onmouseover="showTip(event, 'fs27', 201)" class="vt">float</span><span class="pn">*</span><span onmouseout="hideTip(event, 'fs27', 202)" onmouseover="showTip(event, 'fs27', 202)" class="vt">float</span><span class="pn">&gt;</span><span class="pn">)</span> <span class="o">=</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs77', 203)" onmouseover="showTip(event, 'fs77', 203)" class="fn">s</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs37', 204)" onmouseover="showTip(event, 'fs37', 204)" class="m">Seq</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs78', 205)" onmouseover="showTip(event, 'fs78', 205)" class="id">sumBy</span> <span onmouseout="hideTip(event, 'fs79', 206)" onmouseover="showTip(event, 'fs79', 206)" class="fn">snd</span> <span onmouseout="hideTip(event, 'fs76', 207)" onmouseover="showTip(event, 'fs76', 207)" class="fn">a</span> 
    <span onmouseout="hideTip(event, 'fs37', 208)" onmouseover="showTip(event, 'fs37', 208)" class="m">Seq</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs41', 209)" onmouseover="showTip(event, 'fs41', 209)" class="id">map</span> <span class="pn">(</span><span class="k">fun</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs80', 210)" onmouseover="showTip(event, 'fs80', 210)" class="fn">x</span><span class="pn">,</span><span onmouseout="hideTip(event, 'fs81', 211)" onmouseover="showTip(event, 'fs81', 211)" class="fn">y</span><span class="pn">)</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs80', 212)" onmouseover="showTip(event, 'fs80', 212)" class="fn">x</span><span class="pn">,</span><span onmouseout="hideTip(event, 'fs81', 213)" onmouseover="showTip(event, 'fs81', 213)" class="fn">y</span> <span class="o">/</span> <span onmouseout="hideTip(event, 'fs77', 214)" onmouseover="showTip(event, 'fs77', 214)" class="fn">s</span><span class="pn">)</span> <span onmouseout="hideTip(event, 'fs76', 215)" onmouseover="showTip(event, 'fs76', 215)" class="fn">a</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs82', 216)" onmouseover="showTip(event, 'fs82', 216)" class="fn">compareIsotopicDistributions</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs83', 217)" onmouseover="showTip(event, 'fs83', 217)" class="fn">measured</span><span class="pn">:</span><span onmouseout="hideTip(event, 'fs44', 218)" onmouseover="showTip(event, 'fs44', 218)" class="rt">ExtractedIsoPattern</span><span class="pn">)</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs84', 219)" onmouseover="showTip(event, 'fs84', 219)" class="fn">simulated</span><span class="pn">:</span><span onmouseout="hideTip(event, 'fs66', 220)" onmouseover="showTip(event, 'fs66', 220)" class="rt">SimulatedIsoPattern</span><span class="pn">)</span><span class="o">=</span> 
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs85', 221)" onmouseover="showTip(event, 'fs85', 221)" class="fn">patternSim&#39;</span> <span class="o">=</span> 
        <span onmouseout="hideTip(event, 'fs83', 222)" onmouseover="showTip(event, 'fs83', 222)" class="fn">measured</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs55', 223)" onmouseover="showTip(event, 'fs55', 223)" class="id">Pattern</span> 
        <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs37', 224)" onmouseover="showTip(event, 'fs37', 224)" class="m">Seq</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs41', 225)" onmouseover="showTip(event, 'fs41', 225)" class="id">map</span> <span class="pn">(</span><span class="k">fun</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs86', 226)" onmouseover="showTip(event, 'fs86', 226)" class="fn">mz</span><span class="pn">,</span><span onmouseout="hideTip(event, 'fs87', 227)" onmouseover="showTip(event, 'fs87', 227)" class="fn">intensities</span><span class="pn">)</span> <span class="k">-&gt;</span> 
                <span onmouseout="hideTip(event, 'fs86', 228)" onmouseover="showTip(event, 'fs86', 228)" class="fn">mz</span><span class="pn">,</span>
                <span onmouseout="hideTip(event, 'fs84', 229)" onmouseover="showTip(event, 'fs84', 229)" class="fn">simulated</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs73', 230)" onmouseover="showTip(event, 'fs73', 230)" class="id">SimPattern</span>
                <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs37', 231)" onmouseover="showTip(event, 'fs37', 231)" class="m">Seq</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs88', 232)" onmouseover="showTip(event, 'fs88', 232)" class="id">filter</span> <span class="pn">(</span><span class="k">fun</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs89', 233)" onmouseover="showTip(event, 'fs89', 233)" class="fn">mzSim</span><span class="pn">,</span><span onmouseout="hideTip(event, 'fs90', 234)" onmouseover="showTip(event, 'fs90', 234)" class="fn">intensitiesSim</span><span class="pn">)</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs91', 235)" onmouseover="showTip(event, 'fs91', 235)" class="fn">abs</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs89', 236)" onmouseover="showTip(event, 'fs89', 236)" class="fn">mzSim</span><span class="o">-</span><span onmouseout="hideTip(event, 'fs86', 237)" onmouseover="showTip(event, 'fs86', 237)" class="fn">mz</span><span class="pn">)</span> <span class="o">&lt;</span> <span class="n">0.05</span> <span class="pn">)</span>
                <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs37', 238)" onmouseover="showTip(event, 'fs37', 238)" class="m">Seq</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs78', 239)" onmouseover="showTip(event, 'fs78', 239)" class="id">sumBy</span> <span onmouseout="hideTip(event, 'fs79', 240)" onmouseover="showTip(event, 'fs79', 240)" class="fn">snd</span>
            <span class="pn">)</span>
        <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs75', 241)" onmouseover="showTip(event, 'fs75', 241)" class="fn">normBySum</span>
    <span class="pn">{|</span>
        <span class="prop">Plot</span> <span class="o">=</span> 
            <span class="pn">[</span>
            <span onmouseout="hideTip(event, 'fs32', 242)" onmouseover="showTip(event, 'fs32', 242)" class="fn">plotIsotopicPattern</span> <span class="id">FSharpAux</span><span class="pn">.</span><span class="id">Colors</span><span class="pn">.</span><span class="id">Table</span><span class="pn">.</span><span class="id">Office</span><span class="pn">.</span><span class="id">blue</span> <span onmouseout="hideTip(event, 'fs83', 243)" onmouseover="showTip(event, 'fs83', 243)" class="fn">measured</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs55', 244)" onmouseover="showTip(event, 'fs55', 244)" class="id">Pattern</span>
            <span onmouseout="hideTip(event, 'fs32', 245)" onmouseover="showTip(event, 'fs32', 245)" class="fn">plotIsotopicPattern</span> <span class="id">FSharpAux</span><span class="pn">.</span><span class="id">Colors</span><span class="pn">.</span><span class="id">Table</span><span class="pn">.</span><span class="id">Office</span><span class="pn">.</span><span class="id">orange</span> <span onmouseout="hideTip(event, 'fs85', 246)" onmouseover="showTip(event, 'fs85', 246)" class="fn">patternSim&#39;</span>
            <span class="pn">]</span>
            <span class="o">|&gt;</span> <span class="id">Chart</span><span class="pn">.</span><span class="id">combine</span>
    <span class="pn">|}</span>
</code></pre>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs92', 247)" onmouseover="showTip(event, 'fs92', 247)" class="id">comp1</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs82', 248)" onmouseover="showTip(event, 'fs82', 248)" class="fn">compareIsotopicDistributions</span> <span onmouseout="hideTip(event, 'fs56', 249)" onmouseover="showTip(event, 'fs56', 249)" class="id">examplePep2</span> <span onmouseout="hideTip(event, 'fs72', 250)" onmouseover="showTip(event, 'fs72', 250)" class="id">examplePep2_Sim1</span>
<span onmouseout="hideTip(event, 'fs92', 251)" onmouseover="showTip(event, 'fs92', 251)" class="id">comp1</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs93', 252)" onmouseover="showTip(event, 'fs93', 252)" class="id">Plot</span>
</code></pre>
<table class="pre"><tr><td><pre><code>No value returned by any evaluator</code></pre></td></tr></table>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs94', 255)" onmouseover="showTip(event, 'fs94', 255)" class="id">comp2</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs82', 256)" onmouseover="showTip(event, 'fs82', 256)" class="fn">compareIsotopicDistributions</span> <span onmouseout="hideTip(event, 'fs56', 257)" onmouseover="showTip(event, 'fs56', 257)" class="id">examplePep2</span> <span onmouseout="hideTip(event, 'fs74', 258)" onmouseover="showTip(event, 'fs74', 258)" class="id">examplePep2_Sim2</span>
<span onmouseout="hideTip(event, 'fs94', 259)" onmouseover="showTip(event, 'fs94', 259)" class="id">comp2</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs93', 260)" onmouseover="showTip(event, 'fs93', 260)" class="id">Plot</span>
</code></pre>
<table class="pre"><tr><td><pre><code>No value returned by any evaluator</code></pre></td></tr></table>
<p>Comparing both simulations, we see that the simulation with a label efficiency of 0.99 fits the measured spectra better than the simulation with 0.95.
But since we do not want to find a better fit, but the best fit to our measured pattern, this is no goal that is achievable in a feasable way
using visual inspections. As a solution we utilize the fact that isotopic patterns can be abstracted as <strong><em> </em></strong> (See: How are distributions called that sum up to 1?) distributions.
A measure to compare measured and theoretical distributions is the kullback leibler divergence. The following code block extends the function
'compareIsotopicDistributions' to compute the KL divergence between the precisely measured distribution p and our approximation
of p (q) using the mida algorithm.</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="c">/// Calculates the Kullback-Leibler divergence Dkl(p||q) from q (theory, model, description, or approximation of p) </span>
<span class="c">/// to p (the &quot;true&quot; distribution of data, observations, or a ___ ___ precisely measured).</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs95', 263)" onmouseover="showTip(event, 'fs95', 263)" class="fn">klDiv</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs96', 264)" onmouseover="showTip(event, 'fs96', 264)" class="fn">p</span><span class="pn">:</span><span onmouseout="hideTip(event, 'fs45', 265)" onmouseover="showTip(event, 'fs45', 265)" class="if">seq</span><span class="pn">&lt;</span><span onmouseout="hideTip(event, 'fs27', 266)" onmouseover="showTip(event, 'fs27', 266)" class="vt">float</span><span class="pn">&gt;</span><span class="pn">)</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs97', 267)" onmouseover="showTip(event, 'fs97', 267)" class="fn">q</span><span class="pn">:</span><span onmouseout="hideTip(event, 'fs45', 268)" onmouseover="showTip(event, 'fs45', 268)" class="if">seq</span><span class="pn">&lt;</span><span onmouseout="hideTip(event, 'fs27', 269)" onmouseover="showTip(event, 'fs27', 269)" class="vt">float</span><span class="pn">&gt;</span><span class="pn">)</span> <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs37', 270)" onmouseover="showTip(event, 'fs37', 270)" class="m">Seq</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs98', 271)" onmouseover="showTip(event, 'fs98', 271)" class="id">fold2</span> <span class="pn">(</span><span class="k">fun</span> <span onmouseout="hideTip(event, 'fs99', 272)" onmouseover="showTip(event, 'fs99', 272)" class="fn">acc</span> <span onmouseout="hideTip(event, 'fs100', 273)" onmouseover="showTip(event, 'fs100', 273)" class="fn">p</span> <span onmouseout="hideTip(event, 'fs101', 274)" onmouseover="showTip(event, 'fs101', 274)" class="fn">q</span> <span class="k">-&gt;</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs102', 275)" onmouseover="showTip(event, 'fs102', 275)" class="id">System</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs103', 276)" onmouseover="showTip(event, 'fs103', 276)" class="rt">Math</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs104', 277)" onmouseover="showTip(event, 'fs104', 277)" class="id">Log</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs100', 278)" onmouseover="showTip(event, 'fs100', 278)" class="fn">p</span><span class="o">/</span><span onmouseout="hideTip(event, 'fs101', 279)" onmouseover="showTip(event, 'fs101', 279)" class="fn">q</span><span class="pn">)</span><span class="o">*</span><span onmouseout="hideTip(event, 'fs100', 280)" onmouseover="showTip(event, 'fs100', 280)" class="fn">p</span><span class="pn">)</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs99', 281)" onmouseover="showTip(event, 'fs99', 281)" class="fn">acc</span> <span class="pn">)</span> <span class="n">0.</span> <span onmouseout="hideTip(event, 'fs96', 282)" onmouseover="showTip(event, 'fs96', 282)" class="fn">p</span> <span onmouseout="hideTip(event, 'fs97', 283)" onmouseover="showTip(event, 'fs97', 283)" class="fn">q</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs105', 284)" onmouseover="showTip(event, 'fs105', 284)" class="fn">compareIsotopicDistributions&#39;</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs83', 285)" onmouseover="showTip(event, 'fs83', 285)" class="fn">measured</span><span class="pn">:</span><span onmouseout="hideTip(event, 'fs44', 286)" onmouseover="showTip(event, 'fs44', 286)" class="rt">ExtractedIsoPattern</span><span class="pn">)</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs84', 287)" onmouseover="showTip(event, 'fs84', 287)" class="fn">simulated</span><span class="pn">:</span><span onmouseout="hideTip(event, 'fs66', 288)" onmouseover="showTip(event, 'fs66', 288)" class="rt">SimulatedIsoPattern</span><span class="pn">)</span><span class="o">=</span> 
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs85', 289)" onmouseover="showTip(event, 'fs85', 289)" class="fn">patternSim&#39;</span> <span class="o">=</span> 
        <span onmouseout="hideTip(event, 'fs83', 290)" onmouseover="showTip(event, 'fs83', 290)" class="fn">measured</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs55', 291)" onmouseover="showTip(event, 'fs55', 291)" class="id">Pattern</span> 
        <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs37', 292)" onmouseover="showTip(event, 'fs37', 292)" class="m">Seq</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs41', 293)" onmouseover="showTip(event, 'fs41', 293)" class="id">map</span> <span class="pn">(</span><span class="k">fun</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs86', 294)" onmouseover="showTip(event, 'fs86', 294)" class="fn">mz</span><span class="pn">,</span><span onmouseout="hideTip(event, 'fs87', 295)" onmouseover="showTip(event, 'fs87', 295)" class="fn">intensities</span><span class="pn">)</span> <span class="k">-&gt;</span> 
                <span onmouseout="hideTip(event, 'fs86', 296)" onmouseover="showTip(event, 'fs86', 296)" class="fn">mz</span><span class="pn">,</span>
                <span onmouseout="hideTip(event, 'fs84', 297)" onmouseover="showTip(event, 'fs84', 297)" class="fn">simulated</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs73', 298)" onmouseover="showTip(event, 'fs73', 298)" class="id">SimPattern</span>
                <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs37', 299)" onmouseover="showTip(event, 'fs37', 299)" class="m">Seq</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs88', 300)" onmouseover="showTip(event, 'fs88', 300)" class="id">filter</span> <span class="pn">(</span><span class="k">fun</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs89', 301)" onmouseover="showTip(event, 'fs89', 301)" class="fn">mzSim</span><span class="pn">,</span><span onmouseout="hideTip(event, 'fs90', 302)" onmouseover="showTip(event, 'fs90', 302)" class="fn">intensitiesSim</span><span class="pn">)</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs91', 303)" onmouseover="showTip(event, 'fs91', 303)" class="fn">abs</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs89', 304)" onmouseover="showTip(event, 'fs89', 304)" class="fn">mzSim</span><span class="o">-</span><span onmouseout="hideTip(event, 'fs86', 305)" onmouseover="showTip(event, 'fs86', 305)" class="fn">mz</span><span class="pn">)</span> <span class="o">&lt;</span> <span class="n">0.05</span> <span class="pn">)</span>
                <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs37', 306)" onmouseover="showTip(event, 'fs37', 306)" class="m">Seq</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs78', 307)" onmouseover="showTip(event, 'fs78', 307)" class="id">sumBy</span> <span onmouseout="hideTip(event, 'fs79', 308)" onmouseover="showTip(event, 'fs79', 308)" class="fn">snd</span>
            <span class="pn">)</span>
        <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs75', 309)" onmouseover="showTip(event, 'fs75', 309)" class="fn">normBySum</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs106', 310)" onmouseover="showTip(event, 'fs106', 310)" class="fn">klDiv</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs106', 311)" onmouseover="showTip(event, 'fs106', 311)" class="fn">klDiv</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs85', 312)" onmouseover="showTip(event, 'fs85', 312)" class="fn">patternSim&#39;</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs37', 313)" onmouseover="showTip(event, 'fs37', 313)" class="m">Seq</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs41', 314)" onmouseover="showTip(event, 'fs41', 314)" class="id">map</span> <span onmouseout="hideTip(event, 'fs79', 315)" onmouseover="showTip(event, 'fs79', 315)" class="fn">snd</span><span class="pn">)</span>  <span class="pn">(</span><span onmouseout="hideTip(event, 'fs83', 316)" onmouseover="showTip(event, 'fs83', 316)" class="fn">measured</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs55', 317)" onmouseover="showTip(event, 'fs55', 317)" class="id">Pattern</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs37', 318)" onmouseover="showTip(event, 'fs37', 318)" class="m">Seq</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs41', 319)" onmouseover="showTip(event, 'fs41', 319)" class="id">map</span> <span onmouseout="hideTip(event, 'fs79', 320)" onmouseover="showTip(event, 'fs79', 320)" class="fn">snd</span><span class="pn">)</span>
    <span class="pn">{|</span>
        <span class="prop">KLDiv</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs106', 321)" onmouseover="showTip(event, 'fs106', 321)" class="fn">klDiv</span>
        <span class="prop">Plot</span>  <span class="o">=</span> 
            <span class="pn">[</span>
            <span onmouseout="hideTip(event, 'fs32', 322)" onmouseover="showTip(event, 'fs32', 322)" class="fn">plotIsotopicPattern</span> <span class="id">FSharpAux</span><span class="pn">.</span><span class="id">Colors</span><span class="pn">.</span><span class="id">Table</span><span class="pn">.</span><span class="id">Office</span><span class="pn">.</span><span class="id">blue</span> <span onmouseout="hideTip(event, 'fs83', 323)" onmouseover="showTip(event, 'fs83', 323)" class="fn">measured</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs55', 324)" onmouseover="showTip(event, 'fs55', 324)" class="id">Pattern</span>
            <span onmouseout="hideTip(event, 'fs32', 325)" onmouseover="showTip(event, 'fs32', 325)" class="fn">plotIsotopicPattern</span> <span class="id">FSharpAux</span><span class="pn">.</span><span class="id">Colors</span><span class="pn">.</span><span class="id">Table</span><span class="pn">.</span><span class="id">Office</span><span class="pn">.</span><span class="id">orange</span> <span onmouseout="hideTip(event, 'fs85', 326)" onmouseover="showTip(event, 'fs85', 326)" class="fn">patternSim&#39;</span>
            <span class="pn">]</span>
            <span class="o">|&gt;</span> <span class="id">Chart</span><span class="pn">.</span><span class="id">combine</span>
    <span class="pn">|}</span>
</code></pre>
<h2><a name="V-Determining-the-lable-efficiency-an-optimiziation-problem" class="anchor" href="#V-Determining-the-lable-efficiency-an-optimiziation-problem">V. Determining the lable efficiency: an optimiziation problem.</a></h2>
<p>Using this function we can now visualize the kullback leibler divergence between
different models and the two peptides we measured. Since the lower the divergence. We will
also visualize the pattern with the best fit. Please inspect the Chart created by 'Chart.Point(lableEfficiency,comparison |&gt; Seq.map (fun x -&gt; x.KLDiv))'
and write correct descriptions for the x and the y axis. (Fill: |&gt; Chart.withX<em>AxisStyle "" and |&gt; Chart.withY</em>AxisStyle "")</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs107', 327)" onmouseover="showTip(event, 'fs107', 327)" class="id">lableEfficiency</span><span class="pn">,</span><span onmouseout="hideTip(event, 'fs108', 328)" onmouseover="showTip(event, 'fs108', 328)" class="id">comparison</span> <span class="o">=</span> 
    <span class="pn">[|</span><span class="o">0.95</span> <span class="o">..</span> <span class="n">0.001</span> <span class="o">..</span> <span class="n">0.999</span><span class="pn">|]</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs13', 329)" onmouseover="showTip(event, 'fs13', 329)" class="m">Array</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs26', 330)" onmouseover="showTip(event, 'fs26', 330)" class="id">map</span> <span class="pn">(</span><span class="k">fun</span> <span onmouseout="hideTip(event, 'fs109', 331)" onmouseover="showTip(event, 'fs109', 331)" class="fn">lableEfficiency</span> <span class="k">-&gt;</span> 
            <span class="k">let</span> <span onmouseout="hideTip(event, 'fs110', 332)" onmouseover="showTip(event, 'fs110', 332)" class="fn">sim</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs68', 333)" onmouseover="showTip(event, 'fs68', 333)" class="fn">simulateFrom</span> <span class="s">&quot;DTDILAAFR&quot;</span> <span class="n">2</span> <span onmouseout="hideTip(event, 'fs109', 334)" onmouseover="showTip(event, 'fs109', 334)" class="fn">lableEfficiency</span>
            <span class="k">let</span> <span onmouseout="hideTip(event, 'fs111', 335)" onmouseover="showTip(event, 'fs111', 335)" class="fn">comp</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs105', 336)" onmouseover="showTip(event, 'fs105', 336)" class="fn">compareIsotopicDistributions&#39;</span> <span onmouseout="hideTip(event, 'fs54', 337)" onmouseover="showTip(event, 'fs54', 337)" class="id">examplePep1</span> <span onmouseout="hideTip(event, 'fs110', 338)" onmouseover="showTip(event, 'fs110', 338)" class="fn">sim</span>
            <span onmouseout="hideTip(event, 'fs109', 339)" onmouseover="showTip(event, 'fs109', 339)" class="fn">lableEfficiency</span><span class="pn">,</span>
            <span onmouseout="hideTip(event, 'fs111', 340)" onmouseover="showTip(event, 'fs111', 340)" class="fn">comp</span>
        <span class="pn">)</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs37', 341)" onmouseover="showTip(event, 'fs37', 341)" class="m">Seq</span><span class="pn">.</span><span class="id">unzip</span> 
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs112', 342)" onmouseover="showTip(event, 'fs112', 342)" class="id">bestFit</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs108', 343)" onmouseover="showTip(event, 'fs108', 343)" class="id">comparison</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs37', 344)" onmouseover="showTip(event, 'fs37', 344)" class="m">Seq</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs38', 345)" onmouseover="showTip(event, 'fs38', 345)" class="id">minBy</span> <span class="pn">(</span><span class="k">fun</span> <span onmouseout="hideTip(event, 'fs113', 346)" onmouseover="showTip(event, 'fs113', 346)" class="fn">x</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs113', 347)" onmouseover="showTip(event, 'fs113', 347)" class="fn">x</span><span class="pn">.</span><span class="id">KLDiv</span><span class="pn">)</span> 

<span class="id">Chart</span><span class="pn">.</span><span class="id">Point</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs107', 348)" onmouseover="showTip(event, 'fs107', 348)" class="id">lableEfficiency</span><span class="pn">,</span><span onmouseout="hideTip(event, 'fs108', 349)" onmouseover="showTip(event, 'fs108', 349)" class="id">comparison</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs37', 350)" onmouseover="showTip(event, 'fs37', 350)" class="id">Seq</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs41', 351)" onmouseover="showTip(event, 'fs41', 351)" class="id">map</span> <span class="pn">(</span><span class="k">fun</span> <span class="id">x</span> <span class="k">-&gt;</span> <span class="id">x</span><span class="pn">.</span><span class="id">KLDiv</span><span class="pn">)</span><span class="pn">)</span>
<span class="o">|&gt;</span> <span class="id">Chart</span><span class="pn">.</span><span class="id">withXAxisStyle</span> <span class="s">&quot;&quot;</span>
<span class="o">|&gt;</span> <span class="id">Chart</span><span class="pn">.</span><span class="id">withYAxisStyle</span> <span class="s">&quot;&quot;</span>
</code></pre>
<table class="pre"><tr><td><pre><code>No value returned by any evaluator</code></pre></td></tr></table>
<pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs112', 356)" onmouseover="showTip(event, 'fs112', 356)" class="id">bestFit</span><span class="pn">.</span><span class="id">Plot</span>
</code></pre>
<table class="pre"><tr><td><pre><code>No value returned by any evaluator</code></pre></td></tr></table>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs114', 358)" onmouseover="showTip(event, 'fs114', 358)" class="id">lableEfficiency2</span><span class="pn">,</span><span onmouseout="hideTip(event, 'fs115', 359)" onmouseover="showTip(event, 'fs115', 359)" class="id">comparison2</span> <span class="o">=</span> 
    <span class="pn">[|</span><span class="o">0.95</span> <span class="o">..</span> <span class="n">0.001</span> <span class="o">..</span> <span class="n">0.999</span><span class="pn">|]</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs13', 360)" onmouseover="showTip(event, 'fs13', 360)" class="m">Array</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs26', 361)" onmouseover="showTip(event, 'fs26', 361)" class="id">map</span> <span class="pn">(</span><span class="k">fun</span> <span onmouseout="hideTip(event, 'fs109', 362)" onmouseover="showTip(event, 'fs109', 362)" class="fn">lableEfficiency</span> <span class="k">-&gt;</span> 
            <span class="k">let</span> <span onmouseout="hideTip(event, 'fs110', 363)" onmouseover="showTip(event, 'fs110', 363)" class="fn">sim</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs68', 364)" onmouseover="showTip(event, 'fs68', 364)" class="fn">simulateFrom</span> <span class="s">&quot;LTYYTPDYVVR&quot;</span> <span class="n">2</span> <span onmouseout="hideTip(event, 'fs109', 365)" onmouseover="showTip(event, 'fs109', 365)" class="fn">lableEfficiency</span>
            <span class="k">let</span> <span onmouseout="hideTip(event, 'fs111', 366)" onmouseover="showTip(event, 'fs111', 366)" class="fn">comp</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs105', 367)" onmouseover="showTip(event, 'fs105', 367)" class="fn">compareIsotopicDistributions&#39;</span> <span onmouseout="hideTip(event, 'fs56', 368)" onmouseover="showTip(event, 'fs56', 368)" class="id">examplePep2</span> <span onmouseout="hideTip(event, 'fs110', 369)" onmouseover="showTip(event, 'fs110', 369)" class="fn">sim</span>
            <span onmouseout="hideTip(event, 'fs109', 370)" onmouseover="showTip(event, 'fs109', 370)" class="fn">lableEfficiency</span><span class="pn">,</span>
            <span onmouseout="hideTip(event, 'fs111', 371)" onmouseover="showTip(event, 'fs111', 371)" class="fn">comp</span>
        <span class="pn">)</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs37', 372)" onmouseover="showTip(event, 'fs37', 372)" class="m">Seq</span><span class="pn">.</span><span class="id">unzip</span> 

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs116', 373)" onmouseover="showTip(event, 'fs116', 373)" class="id">bestFit2</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs115', 374)" onmouseover="showTip(event, 'fs115', 374)" class="id">comparison2</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs37', 375)" onmouseover="showTip(event, 'fs37', 375)" class="m">Seq</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs38', 376)" onmouseover="showTip(event, 'fs38', 376)" class="id">minBy</span> <span class="pn">(</span><span class="k">fun</span> <span onmouseout="hideTip(event, 'fs113', 377)" onmouseover="showTip(event, 'fs113', 377)" class="fn">x</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs113', 378)" onmouseover="showTip(event, 'fs113', 378)" class="fn">x</span><span class="pn">.</span><span class="id">KLDiv</span><span class="pn">)</span> 

<span class="id">Chart</span><span class="pn">.</span><span class="id">Point</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs114', 379)" onmouseover="showTip(event, 'fs114', 379)" class="id">lableEfficiency2</span><span class="pn">,</span><span onmouseout="hideTip(event, 'fs115', 380)" onmouseover="showTip(event, 'fs115', 380)" class="id">comparison2</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs37', 381)" onmouseover="showTip(event, 'fs37', 381)" class="id">Seq</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs41', 382)" onmouseover="showTip(event, 'fs41', 382)" class="id">map</span> <span class="pn">(</span><span class="k">fun</span> <span class="id">x</span> <span class="k">-&gt;</span> <span class="id">x</span><span class="pn">.</span><span class="id">KLDiv</span><span class="pn">)</span><span class="pn">)</span>
<span class="o">|&gt;</span> <span class="id">Chart</span><span class="pn">.</span><span class="id">withXAxisStyle</span> <span class="s">&quot;&quot;</span>
<span class="o">|&gt;</span> <span class="id">Chart</span><span class="pn">.</span><span class="id">withYAxisStyle</span> <span class="s">&quot;&quot;</span>
</code></pre>
<table class="pre"><tr><td><pre><code>No value returned by any evaluator</code></pre></td></tr></table>
<pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs116', 387)" onmouseover="showTip(event, 'fs116', 387)" class="id">bestFit2</span><span class="pn">.</span><span class="id">Plot</span>
</code></pre>
<table class="pre"><tr><td><pre><code>No value returned by any evaluator</code></pre></td></tr></table>
<p>Observing the output, we can make two observations: the function x(lablefficiency) = KL(measured,sim(lableeffciency)) has in both cases a local minimum
that is similar, yet slightly different for peptides "LTYYTPDYVVR" and "DTDILAAFR", and that the best fit resembles the measured distribution closely, but not
perfectly, what is the reason for this?</p>
<p>Finding this local minimum will give us the best estimator for the lable efficiency. This can be done using brute force approaches (as we just did)
or more elaborate optimization techniques. For this we will use an algorithm called 'Brent's method'. This method is more precise and speeds up the calculation time (Why?).
How close are the estimates?</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs117', 389)" onmouseover="showTip(event, 'fs117', 389)" class="fn">calcKL</span> <span onmouseout="hideTip(event, 'fs118', 390)" onmouseover="showTip(event, 'fs118', 390)" class="fn">peptideSequence</span> <span onmouseout="hideTip(event, 'fs64', 391)" onmouseover="showTip(event, 'fs64', 391)" class="fn">charge</span> <span onmouseout="hideTip(event, 'fs109', 392)" onmouseover="showTip(event, 'fs109', 392)" class="fn">lableEfficiency</span> <span class="o">=</span> 
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs119', 393)" onmouseover="showTip(event, 'fs119', 393)" class="fn">measured</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs46', 394)" onmouseover="showTip(event, 'fs46', 394)" class="fn">getIsotopicPattern</span> <span onmouseout="hideTip(event, 'fs118', 395)" onmouseover="showTip(event, 'fs118', 395)" class="fn">peptideSequence</span> <span onmouseout="hideTip(event, 'fs64', 396)" onmouseover="showTip(event, 'fs64', 396)" class="fn">charge</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs110', 397)" onmouseover="showTip(event, 'fs110', 397)" class="fn">sim</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs68', 398)" onmouseover="showTip(event, 'fs68', 398)" class="fn">simulateFrom</span> <span onmouseout="hideTip(event, 'fs118', 399)" onmouseover="showTip(event, 'fs118', 399)" class="fn">peptideSequence</span> <span onmouseout="hideTip(event, 'fs64', 400)" onmouseover="showTip(event, 'fs64', 400)" class="fn">charge</span> <span onmouseout="hideTip(event, 'fs109', 401)" onmouseover="showTip(event, 'fs109', 401)" class="fn">lableEfficiency</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs111', 402)" onmouseover="showTip(event, 'fs111', 402)" class="fn">comp</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs105', 403)" onmouseover="showTip(event, 'fs105', 403)" class="fn">compareIsotopicDistributions&#39;</span> <span onmouseout="hideTip(event, 'fs119', 404)" onmouseover="showTip(event, 'fs119', 404)" class="fn">measured</span> <span onmouseout="hideTip(event, 'fs110', 405)" onmouseover="showTip(event, 'fs110', 405)" class="fn">sim</span>
    <span onmouseout="hideTip(event, 'fs111', 406)" onmouseover="showTip(event, 'fs111', 406)" class="fn">comp</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs120', 407)" onmouseover="showTip(event, 'fs120', 407)" class="id">KLDiv</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs121', 408)" onmouseover="showTip(event, 'fs121', 408)" class="id">est1</span> <span class="o">=</span> <span class="id">Optimization</span><span class="pn">.</span><span class="id">Brent</span><span class="pn">.</span><span class="id">minimize</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs117', 409)" onmouseover="showTip(event, 'fs117', 409)" class="id">calcKL</span> <span class="s">&quot;DTDILAAFR&quot;</span> <span class="n">2</span><span class="pn">)</span> <span class="n">0.98</span> <span class="n">0.999</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs122', 410)" onmouseover="showTip(event, 'fs122', 410)" class="id">est2</span> <span class="o">=</span> <span class="id">Optimization</span><span class="pn">.</span><span class="id">Brent</span><span class="pn">.</span><span class="id">minimize</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs117', 411)" onmouseover="showTip(event, 'fs117', 411)" class="id">calcKL</span> <span class="s">&quot;LTYYTPDYVVR&quot;</span> <span class="n">2</span><span class="pn">)</span> <span class="n">0.98</span> <span class="n">0.999</span>
</code></pre>
<p>Since the estimates have a certain level of uncertainty we will repeat the estimation for
some high intensity peptides and visualize the results. Please fill the x axis description (|&gt; Chart.withX_AxisStyle "")</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs123', 412)" onmouseover="showTip(event, 'fs123', 412)" class="id">highIntensityPeptides</span> <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs19', 413)" onmouseover="showTip(event, 'fs19', 413)" class="id">heavy</span>
    <span class="o">|&gt;</span> <span class="id">Frame</span><span class="pn">.</span><span class="id">getCol</span> <span class="s">&quot;WCGr1_U1&quot;</span> 
    <span class="o">|&gt;</span> <span class="id">Series</span><span class="pn">.</span><span class="id">sortBy</span> <span class="pn">(</span><span class="k">fun</span> <span class="pn">(</span><span class="id">x</span><span class="pn">:</span><span onmouseout="hideTip(event, 'fs27', 414)" onmouseover="showTip(event, 'fs27', 414)" class="id">float</span><span class="pn">)</span> <span class="k">-&gt;</span> <span class="o">-</span> <span class="id">x</span><span class="pn">)</span>
    <span class="o">|&gt;</span> <span class="id">Series</span><span class="pn">.</span><span class="id">filter</span> <span class="pn">(</span><span class="k">fun</span> <span class="id">k</span> <span class="id">v</span> <span class="k">-&gt;</span> <span class="id">k</span><span class="pn">.</span><span class="id">StringSequence</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs10', 415)" onmouseover="showTip(event, 'fs10', 415)" class="id">String</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs124', 416)" onmouseover="showTip(event, 'fs124', 416)" class="id">exists</span> <span class="pn">(</span><span class="k">fun</span> <span class="id">x</span> <span class="k">-&gt;</span> <span class="id">x</span><span class="o">=</span><span class="s">&#39;[&#39;</span><span class="pn">)</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs125', 417)" onmouseover="showTip(event, 'fs125', 417)" class="id">not</span><span class="pn">)</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs126', 418)" onmouseover="showTip(event, 'fs126', 418)" class="id">estimates</span> <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs123', 419)" onmouseover="showTip(event, 'fs123', 419)" class="id">highIntensityPeptides</span>
    <span class="o">|&gt;</span> <span class="id">Series</span><span class="pn">.</span><span class="id">take</span> <span class="n">20</span> 
    <span class="o">|&gt;</span> <span class="id">Series</span><span class="pn">.</span><span class="id">map</span> <span class="pn">(</span><span class="k">fun</span> <span class="id">k</span> <span class="id">v</span> <span class="k">-&gt;</span> 
        <span onmouseout="hideTip(event, 'fs1', 420)" onmouseover="showTip(event, 'fs1', 420)" class="id">FSharp</span><span class="pn">.</span><span class="id">Stats</span><span class="pn">.</span><span class="id">Optimization</span><span class="pn">.</span><span class="id">Brent</span><span class="pn">.</span><span class="id">minimize</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs117', 421)" onmouseover="showTip(event, 'fs117', 421)" class="id">calcKL</span> <span class="id">k</span><span class="pn">.</span><span class="id">StringSequence</span> <span class="id">k</span><span class="pn">.</span><span class="id">Charge</span><span class="pn">)</span> <span class="n">0.98</span> <span class="n">0.999</span>
        <span class="pn">)</span>
    <span class="o">|&gt;</span> <span class="id">Series</span><span class="pn">.</span><span class="id">values</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs37', 422)" onmouseover="showTip(event, 'fs37', 422)" class="m">Seq</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs127', 423)" onmouseover="showTip(event, 'fs127', 423)" class="id">choose</span> <span onmouseout="hideTip(event, 'fs128', 424)" onmouseover="showTip(event, 'fs128', 424)" class="fn">id</span>

<span class="id">Chart</span><span class="pn">.</span><span class="id">BoxPlot</span> <span onmouseout="hideTip(event, 'fs126', 425)" onmouseover="showTip(event, 'fs126', 425)" class="id">estimates</span>
<span class="o">|&gt;</span> <span class="id">Chart</span><span class="pn">.</span><span class="id">withXAxisStyle</span> <span class="s">&quot;&quot;</span>
</code></pre>
<table class="pre"><tr><td><pre><code>No value returned by any evaluator</code></pre></td></tr></table>
<p>Now that we know more than an educated guess of an lable efficiency estimate we can start with our main goal:
the absolute quantification of chlamydomonas proteins!</p>

                </div>
            </div>
        </div>
        <div class="fsdocs-tip" id="fs1">namespace Microsoft.FSharp</div>
<div class="fsdocs-tip" id="fs2">type Qprot =
  | CBB
  | PS</div>
<div class="fsdocs-tip" id="fs3">union case Qprot.CBB: Qprot</div>
<div class="fsdocs-tip" id="fs4">union case Qprot.PS: Qprot</div>
<div class="fsdocs-tip" id="fs5">type PeptideIon = {| Charge: int; PepSequenceID: int; ProteinGroup: string; QProt: Qprot; StringSequence: string; Synonyms: string |}</div>
<div class="fsdocs-tip" id="fs6">Multiple items<br />val string : value:&#39;T -&gt; string<br /><em>&lt;summary&gt;Converts the argument to a string using &lt;c&gt;ToString&lt;/c&gt;.&lt;/summary&gt;<br />&lt;remarks&gt;For standard integer and floating point values the and any type that implements &lt;c&gt;IFormattable&lt;/c&gt;&lt;c&gt;ToString&lt;/c&gt; conversion uses &lt;c&gt;CultureInfo.InvariantCulture&lt;/c&gt;. &lt;/remarks&gt;<br />&lt;param name=&quot;value&quot;&gt;The input value.&lt;/param&gt;<br />&lt;returns&gt;The converted string.&lt;/returns&gt;</em><br /><br />--------------------<br />type string = System.String<br /><em>&lt;summary&gt;An abbreviation for the CLI type &lt;see cref=&quot;T:System.String&quot; /&gt;.&lt;/summary&gt;<br />&lt;category&gt;Basic Types&lt;/category&gt;</em></div>
<div class="fsdocs-tip" id="fs7">Multiple items<br />val int : value:&#39;T -&gt; int (requires member op_Explicit)<br /><em>&lt;summary&gt;Converts the argument to signed 32-bit integer. This is a direct conversion for all 
 primitive numeric types. For strings, the input is converted using &lt;c&gt;Int32.Parse()&lt;/c&gt;  
 with InvariantCulture settings. Otherwise the operation requires an appropriate
 static conversion method on the input type.&lt;/summary&gt;<br />&lt;param name=&quot;value&quot;&gt;The input value.&lt;/param&gt;<br />&lt;returns&gt;The converted int&lt;/returns&gt;</em><br /><br />--------------------<br />[&lt;Struct&gt;]
type int = int32<br /><em>&lt;summary&gt;An abbreviation for the CLI type &lt;see cref=&quot;T:System.Int32&quot; /&gt;.&lt;/summary&gt;<br />&lt;category&gt;Basic Types&lt;/category&gt;</em><br /><br />--------------------<br />type int&lt;&#39;Measure&gt; =
  int<br /><em>&lt;summary&gt;The type of 32-bit signed integer numbers, annotated with a unit of measure. The unit
 of measure is erased in compiled code and when values of this type
 are analyzed using reflection. The type is representationally equivalent to 
 &lt;see cref=&quot;T:System.Int32&quot; /&gt;.&lt;/summary&gt;<br />&lt;category&gt;Basic Types with Units of Measure&lt;/category&gt;</em></div>
<div class="fsdocs-tip" id="fs8">val filePath : string</div>
<div class="fsdocs-tip" id="fs9">val qConcatDataFiltered : obj</div>
<div class="fsdocs-tip" id="fs10">module String

from Microsoft.FSharp.Core<br /><em>&lt;summary&gt;Functional programming operators for string processing.  Further string operations
 are available via the member functions on strings and other functionality in
  &lt;a href=&quot;http://msdn2.microsoft.com/en-us/library/system.string.aspx&quot;&gt;System.String&lt;/a&gt; 
 and &lt;a href=&quot;http://msdn2.microsoft.com/library/system.text.regularexpressions.aspx&quot;&gt;System.Text.RegularExpressions&lt;/a&gt; types.
 &lt;/summary&gt;<br />&lt;category&gt;Strings and Text&lt;/category&gt;</em></div>
<div class="fsdocs-tip" id="fs11">union case Option.Some: Value: &#39;T -&gt; Option&lt;&#39;T&gt;<br /><em>&lt;summary&gt;The representation of &quot;Value of type &#39;T&quot;&lt;/summary&gt;<br />&lt;param name=&quot;Value&quot;&gt;The input value.&lt;/param&gt;<br />&lt;returns&gt;An option representing the value.&lt;/returns&gt;</em></div>
<div class="fsdocs-tip" id="fs12">union case Option.None: Option&lt;&#39;T&gt;<br /><em>&lt;summary&gt;The representation of &quot;No value&quot;&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs13">module Array

from Microsoft.FSharp.Collections<br /><em>&lt;summary&gt;Contains operations for working with arrays.&lt;/summary&gt;<br />&lt;remarks&gt;
  See also &lt;a href=&quot;https://docs.microsoft.com/dotnet/fsharp/language-reference/arrays&quot;&gt;F# Language Guide - Arrays&lt;/a&gt;.
 &lt;/remarks&gt;</em></div>
<div class="fsdocs-tip" id="fs14">val ofSeq : source:seq&lt;&#39;T&gt; -&gt; &#39;T []<br /><em>&lt;summary&gt;Builds a new array from the given enumerable object.&lt;/summary&gt;<br />&lt;param name=&quot;source&quot;&gt;The input sequence.&lt;/param&gt;<br />&lt;returns&gt;The array of elements from the sequence.&lt;/returns&gt;<br />&lt;exception cref=&quot;T:System.ArgumentNullException&quot;&gt;Thrown when the input sequence is null.&lt;/exception&gt;</em></div>
<div class="fsdocs-tip" id="fs15">val sliceQuantColumns : quantColID:&#39;a -&gt; frame:&#39;b -&gt; &#39;c</div>
<div class="fsdocs-tip" id="fs16">val quantColID : &#39;a</div>
<div class="fsdocs-tip" id="fs17">val frame : &#39;b</div>
<div class="fsdocs-tip" id="fs18">val item : index:int -&gt; array:&#39;T [] -&gt; &#39;T<br /><em>&lt;summary&gt;Gets an element from an array.&lt;/summary&gt;<br />&lt;param name=&quot;index&quot;&gt;The input index.&lt;/param&gt;<br />&lt;param name=&quot;array&quot;&gt;The input array.&lt;/param&gt;<br />&lt;returns&gt;The value of the array at the given index.&lt;/returns&gt;<br />&lt;exception cref=&quot;T:System.NullReferenceException&quot;&gt;Thrown when the input array is null.&lt;/exception&gt;<br />&lt;exception cref=&quot;T:System.IndexOutOfRangeException&quot;&gt;Thrown when the index is negative or the input array does not contain enough elements.&lt;/exception&gt;</em></div>
<div class="fsdocs-tip" id="fs19">val heavy : obj</div>
<div class="fsdocs-tip" id="fs20">val heavyPatternMz : obj</div>
<div class="fsdocs-tip" id="fs21">val heavyPatternI : obj</div>
<div class="fsdocs-tip" id="fs22">val getHeavyPatternsInFile : fileName:&#39;a -&gt; &#39;b</div>
<div class="fsdocs-tip" id="fs23">val fileName : &#39;a</div>
<div class="fsdocs-tip" id="fs24">val floatArrayOf : (&#39;c -&gt; float [])</div>
<div class="fsdocs-tip" id="fs25">val s : &#39;c</div>
<div class="fsdocs-tip" id="fs26">val map : mapping:(&#39;T -&gt; &#39;U) -&gt; array:&#39;T [] -&gt; &#39;U []<br /><em>&lt;summary&gt;Builds a new array whose elements are the results of applying the given function
 to each of the elements of the array.&lt;/summary&gt;<br />&lt;param name=&quot;mapping&quot;&gt;The function to transform elements of the array.&lt;/param&gt;<br />&lt;param name=&quot;array&quot;&gt;The input array.&lt;/param&gt;<br />&lt;returns&gt;The array of transformed elements.&lt;/returns&gt;<br />&lt;exception cref=&quot;T:System.ArgumentNullException&quot;&gt;Thrown when the input array is null.&lt;/exception&gt;</em></div>
<div class="fsdocs-tip" id="fs27">Multiple items<br />val float : value:&#39;T -&gt; float (requires member op_Explicit)<br /><em>&lt;summary&gt;Converts the argument to 64-bit float. This is a direct conversion for all 
 primitive numeric types. For strings, the input is converted using &lt;c&gt;Double.Parse()&lt;/c&gt;  
 with InvariantCulture settings. Otherwise the operation requires an appropriate
 static conversion method on the input type.&lt;/summary&gt;<br />&lt;param name=&quot;value&quot;&gt;The input value.&lt;/param&gt;<br />&lt;returns&gt;The converted float&lt;/returns&gt;</em><br /><br />--------------------<br />[&lt;Struct&gt;]
type float = System.Double<br /><em>&lt;summary&gt;An abbreviation for the CLI type &lt;see cref=&quot;T:System.Double&quot; /&gt;.&lt;/summary&gt;<br />&lt;category&gt;Basic Types&lt;/category&gt;</em><br /><br />--------------------<br />type float&lt;&#39;Measure&gt; =
  float<br /><em>&lt;summary&gt;The type of double-precision floating point numbers, annotated with a unit of measure. 
 The unit of measure is erased in compiled code and when values of this type
 are analyzed using reflection. The type is representationally equivalent to 
 &lt;see cref=&quot;T:System.Double&quot; /&gt;.&lt;/summary&gt;<br />&lt;category index=&quot;6&quot;&gt;Basic Types with Units of Measure&lt;/category&gt;</em></div>
<div class="fsdocs-tip" id="fs28">val mz : obj</div>
<div class="fsdocs-tip" id="fs29">val intensities : obj</div>
<div class="fsdocs-tip" id="fs30">val zipped : &#39;b</div>
<div class="fsdocs-tip" id="fs31">val extractedPatterns : obj</div>
<div class="fsdocs-tip" id="fs32">val plotIsotopicPattern : color:&#39;a -&gt; mzsAndintensities:seq&lt;&#39;b * &#39;c&gt; -&gt; &#39;d (requires comparison)</div>
<div class="fsdocs-tip" id="fs33">val color : &#39;a</div>
<div class="fsdocs-tip" id="fs34">val mzsAndintensities : seq&lt;&#39;b * &#39;c&gt; (requires comparison)</div>
<div class="fsdocs-tip" id="fs35">val min : &#39;b (requires comparison)</div>
<div class="fsdocs-tip" id="fs36">val max : &#39;b (requires comparison)</div>
<div class="fsdocs-tip" id="fs37">module Seq

from Microsoft.FSharp.Collections<br /><em>&lt;summary&gt;Contains operations for working with values of type &lt;see cref=&quot;T:Microsoft.FSharp.Collections.seq`1&quot; /&gt;.&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs38">val minBy : projection:(&#39;T -&gt; &#39;U) -&gt; source:seq&lt;&#39;T&gt; -&gt; &#39;T (requires comparison)<br /><em>&lt;summary&gt;Returns the lowest of all elements of the sequence, compared via Operators.min on the function result.&lt;/summary&gt;<br />&lt;param name=&quot;projection&quot;&gt;A function to transform items from the input sequence into comparable keys.&lt;/param&gt;<br />&lt;param name=&quot;source&quot;&gt;The input sequence.&lt;/param&gt;<br />&lt;returns&gt;The smallest element of the sequence.&lt;/returns&gt;<br />&lt;exception cref=&quot;T:System.ArgumentNullException&quot;&gt;Thrown when the input sequence is null.&lt;/exception&gt;<br />&lt;exception cref=&quot;T:System.ArgumentException&quot;&gt;Thrown when the input sequence is empty.&lt;/exception&gt;</em></div>
<div class="fsdocs-tip" id="fs39">val fst : tuple:(&#39;T1 * &#39;T2) -&gt; &#39;T1<br /><em>&lt;summary&gt;Return the first element of a tuple, &lt;c&gt;fst (a,b) = a&lt;/c&gt;.&lt;/summary&gt;<br />&lt;param name=&quot;tuple&quot;&gt;The input tuple.&lt;/param&gt;<br />&lt;returns&gt;The first value.&lt;/returns&gt;</em></div>
<div class="fsdocs-tip" id="fs40">val maxBy : projection:(&#39;T -&gt; &#39;U) -&gt; source:seq&lt;&#39;T&gt; -&gt; &#39;T (requires comparison)<br /><em>&lt;summary&gt;Returns the greatest of all elements of the sequence, compared via Operators.max on the function result.&lt;/summary&gt;<br />&lt;param name=&quot;projection&quot;&gt;A function to transform items from the input sequence into comparable keys.&lt;/param&gt;<br />&lt;param name=&quot;source&quot;&gt;The input sequence.&lt;/param&gt;<br />&lt;returns&gt;The largest element of the sequence.&lt;/returns&gt;<br />&lt;exception cref=&quot;T:System.ArgumentNullException&quot;&gt;Thrown when the input sequence is null.&lt;/exception&gt;<br />&lt;exception cref=&quot;T:System.ArgumentException&quot;&gt;Thrown when the input sequence is empty.&lt;/exception&gt;</em></div>
<div class="fsdocs-tip" id="fs41">val map : mapping:(&#39;T -&gt; &#39;U) -&gt; source:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;U&gt;<br /><em>&lt;summary&gt;Builds a new collection whose elements are the results of applying the given function
 to each of the elements of the collection.  The given function will be applied
 as elements are demanded using the &lt;c&gt;MoveNext&lt;/c&gt; method on enumerators retrieved from the
 object.&lt;/summary&gt;<br />&lt;remarks&gt;The returned sequence may be passed between threads safely. However, 
 individual IEnumerator values generated from the returned sequence should not be accessed concurrently.&lt;/remarks&gt;<br />&lt;param name=&quot;mapping&quot;&gt;A function to transform items from the input sequence.&lt;/param&gt;<br />&lt;param name=&quot;source&quot;&gt;The input sequence.&lt;/param&gt;<br />&lt;returns&gt;The result sequence.&lt;/returns&gt;<br />&lt;exception cref=&quot;T:System.ArgumentNullException&quot;&gt;Thrown when the input sequence is null.&lt;/exception&gt;</em></div>
<div class="fsdocs-tip" id="fs42">val x : &#39;b (requires comparison)</div>
<div class="fsdocs-tip" id="fs43">val y : &#39;c</div>
<div class="fsdocs-tip" id="fs44">type ExtractedIsoPattern = {| Charge: int; Pattern: seq&lt;float * float&gt;; PeptideSequence: PeptideIon |}</div>
<div class="fsdocs-tip" id="fs45">Multiple items<br />val seq : sequence:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;T&gt;<br /><em>&lt;summary&gt;Builds a sequence using sequence expression syntax&lt;/summary&gt;<br />&lt;param name=&quot;sequence&quot;&gt;The input sequence.&lt;/param&gt;<br />&lt;returns&gt;The result sequence.&lt;/returns&gt;</em><br /><br />--------------------<br />type seq&lt;&#39;T&gt; = System.Collections.Generic.IEnumerable&lt;&#39;T&gt;<br /><em>&lt;summary&gt;An abbreviation for the CLI type &lt;see cref=&quot;T:System.Collections.Generic.IEnumerable`1&quot; /&gt;&lt;/summary&gt;<br />&lt;remarks&gt;
  See the &lt;see cref=&quot;T:Microsoft.FSharp.Collections.SeqModule&quot; /&gt; module for further operations related to sequences.

  See also &lt;a href=&quot;https://docs.microsoft.com/dotnet/fsharp/language-reference/sequences&quot;&gt;F# Language Guide - Sequences&lt;/a&gt;.
&lt;/remarks&gt;</em></div>
<div class="fsdocs-tip" id="fs46">val getIsotopicPattern : peptideSequence:&#39;a -&gt; charge:&#39;b -&gt; {| Charge: &#39;b; Pattern: seq&lt;&#39;c * &#39;d&gt;; PeptideSequence: &#39;e |} (requires equality and equality)</div>
<div class="fsdocs-tip" id="fs47">val peptideSequence : &#39;a (requires equality)</div>
<div class="fsdocs-tip" id="fs48">val charge : &#39;b (requires equality)</div>
<div class="fsdocs-tip" id="fs49">val k : &#39;e</div>
<div class="fsdocs-tip" id="fs50">val mzs : seq&lt;&#39;c&gt;</div>
<div class="fsdocs-tip" id="fs51">val intensities : seq&lt;&#39;d&gt;</div>
<div class="fsdocs-tip" id="fs52">val find : predicate:(&#39;T -&gt; bool) -&gt; source:seq&lt;&#39;T&gt; -&gt; &#39;T<br /><em>&lt;summary&gt;Returns the first element for which the given function returns True.&lt;/summary&gt;<br />&lt;param name=&quot;predicate&quot;&gt;A function to test whether an item in the sequence should be returned.&lt;/param&gt;<br />&lt;param name=&quot;source&quot;&gt;The input sequence.&lt;/param&gt;<br />&lt;returns&gt;The first element for which the predicate returns True.&lt;/returns&gt;<br />&lt;exception cref=&quot;T:System.Collections.Generic.KeyNotFoundException&quot;&gt;Thrown if no element returns true when
 evaluated by the predicate&lt;/exception&gt;<br />&lt;exception cref=&quot;T:System.ArgumentNullException&quot;&gt;Thrown when the input sequence is null&lt;/exception&gt;</em></div>
<div class="fsdocs-tip" id="fs53">val zip : source1:seq&lt;&#39;T1&gt; -&gt; source2:seq&lt;&#39;T2&gt; -&gt; seq&lt;&#39;T1 * &#39;T2&gt;<br /><em>&lt;summary&gt;Combines the two sequences into a list of pairs. The two sequences need not have equal lengths:
 when one sequence is exhausted any remaining elements in the other
 sequence are ignored.&lt;/summary&gt;<br />&lt;param name=&quot;source1&quot;&gt;The first input sequence.&lt;/param&gt;<br />&lt;param name=&quot;source2&quot;&gt;The second input sequence.&lt;/param&gt;<br />&lt;returns&gt;The result sequence.&lt;/returns&gt;<br />&lt;exception cref=&quot;T:System.ArgumentNullException&quot;&gt;Thrown when either of the input sequences is null.&lt;/exception&gt;</em></div>
<div class="fsdocs-tip" id="fs54">val examplePep1 : {| Charge: int; Pattern: seq&lt;float * float&gt;; PeptideSequence: PeptideIon |}</div>
<div class="fsdocs-tip" id="fs55">anonymous record field Pattern: seq&lt;float * float&gt;</div>
<div class="fsdocs-tip" id="fs56">val examplePep2 : {| Charge: int; Pattern: seq&lt;float * float&gt;; PeptideSequence: PeptideIon |}</div>
<div class="fsdocs-tip" id="fs57">val toFormula : bioseq:&#39;a -&gt; &#39;b</div>
<div class="fsdocs-tip" id="fs58">val bioseq : &#39;a</div>
<div class="fsdocs-tip" id="fs59">val label : n15LableEfficiency:&#39;a -&gt; formula:&#39;b -&gt; &#39;c</div>
<div class="fsdocs-tip" id="fs60">val n15LableEfficiency : &#39;a</div>
<div class="fsdocs-tip" id="fs61">val formula : &#39;b</div>
<div class="fsdocs-tip" id="fs62">val heavyN15 : obj</div>
<div class="fsdocs-tip" id="fs63">val generateIsotopicDistribution : charge:int -&gt; f:&#39;a -&gt; &#39;b</div>
<div class="fsdocs-tip" id="fs64">val charge : int</div>
<div class="fsdocs-tip" id="fs65">val f : &#39;a</div>
<div class="fsdocs-tip" id="fs66">type SimulatedIsoPattern = {| Charge: int; LableEfficiency: float; PeptideSequence: string; SimPattern: (float * float) list |}</div>
<div class="fsdocs-tip" id="fs67">type &#39;T list = List&lt;&#39;T&gt;<br /><em>&lt;summary&gt;The type of immutable singly-linked lists. &lt;/summary&gt;<br />&lt;remarks&gt;See the &lt;see cref=&quot;T:Microsoft.FSharp.Collections.ListModule&quot; /&gt; module for further operations related to lists.

 Use the constructors &lt;c&gt;[]&lt;/c&gt; and &lt;c&gt;::&lt;/c&gt; (infix) to create values of this type, or
 the notation &lt;c&gt;[1; 2; 3]&lt;/c&gt;. Use the values in the &lt;c&gt;List&lt;/c&gt; module to manipulate 
 values of this type, or pattern match against the values directly.

  See also &lt;a href=&quot;https://docs.microsoft.com/dotnet/fsharp/language-reference/lists&quot;&gt;F# Language Guide - Lists&lt;/a&gt;.
 &lt;/remarks&gt;</em></div>
<div class="fsdocs-tip" id="fs68">val simulateFrom : peptideSequence:&#39;a -&gt; charge:int -&gt; lableEfficiency:&#39;b -&gt; {| Charge: int; LableEfficiency: &#39;b; PeptideSequence: &#39;a; SimPattern: &#39;c |}</div>
<div class="fsdocs-tip" id="fs69">val peptideSequence : &#39;a</div>
<div class="fsdocs-tip" id="fs70">val lableEfficiency : &#39;b</div>
<div class="fsdocs-tip" id="fs71">val simPattern : &#39;c</div>
<div class="fsdocs-tip" id="fs72">val examplePep2_Sim1 : {| Charge: int; LableEfficiency: float; PeptideSequence: string; SimPattern: (float * float) list |}</div>
<div class="fsdocs-tip" id="fs73">anonymous record field SimPattern: (float * float) list</div>
<div class="fsdocs-tip" id="fs74">val examplePep2_Sim2 : {| Charge: int; LableEfficiency: float; PeptideSequence: string; SimPattern: (float * float) list |}</div>
<div class="fsdocs-tip" id="fs75">val normBySum : a:seq&lt;float * float&gt; -&gt; seq&lt;float * float&gt;</div>
<div class="fsdocs-tip" id="fs76">val a : seq&lt;float * float&gt;</div>
<div class="fsdocs-tip" id="fs77">val s : float</div>
<div class="fsdocs-tip" id="fs78">val sumBy : projection:(&#39;T -&gt; &#39;U) -&gt; source:seq&lt;&#39;T&gt; -&gt; &#39;U (requires member ( + ) and member get_Zero)<br /><em>&lt;summary&gt;Returns the sum of the results generated by applying the function to each element of the sequence.&lt;/summary&gt;<br />&lt;remarks&gt;The generated elements are summed using the &lt;c&gt;+&lt;/c&gt; operator and &lt;c&gt;Zero&lt;/c&gt; property associated with the generated type.&lt;/remarks&gt;<br />&lt;param name=&quot;projection&quot;&gt;A function to transform items from the input sequence into the type that will be summed.&lt;/param&gt;<br />&lt;param name=&quot;source&quot;&gt;The input sequence.&lt;/param&gt;<br />&lt;returns&gt;The computed sum.&lt;/returns&gt;</em></div>
<div class="fsdocs-tip" id="fs79">val snd : tuple:(&#39;T1 * &#39;T2) -&gt; &#39;T2<br /><em>&lt;summary&gt;Return the second element of a tuple, &lt;c&gt;snd (a,b) = b&lt;/c&gt;.&lt;/summary&gt;<br />&lt;param name=&quot;tuple&quot;&gt;The input tuple.&lt;/param&gt;<br />&lt;returns&gt;The second value.&lt;/returns&gt;</em></div>
<div class="fsdocs-tip" id="fs80">val x : float</div>
<div class="fsdocs-tip" id="fs81">val y : float</div>
<div class="fsdocs-tip" id="fs82">val compareIsotopicDistributions : measured:ExtractedIsoPattern -&gt; simulated:SimulatedIsoPattern -&gt; {| Plot: &#39;a |}</div>
<div class="fsdocs-tip" id="fs83">val measured : ExtractedIsoPattern</div>
<div class="fsdocs-tip" id="fs84">val simulated : SimulatedIsoPattern</div>
<div class="fsdocs-tip" id="fs85">val patternSim&#39; : seq&lt;float * float&gt;</div>
<div class="fsdocs-tip" id="fs86">val mz : float</div>
<div class="fsdocs-tip" id="fs87">val intensities : float</div>
<div class="fsdocs-tip" id="fs88">val filter : predicate:(&#39;T -&gt; bool) -&gt; source:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;T&gt;<br /><em>&lt;summary&gt;Returns a new collection containing only the elements of the collection
 for which the given predicate returns &quot;true&quot;. This is a synonym for Seq.where.&lt;/summary&gt;<br />&lt;remarks&gt;The returned sequence may be passed between threads safely. However, 
 individual IEnumerator values generated from the returned sequence should not be accessed concurrently.

 Remember sequence is lazy, effects are delayed until it is enumerated.&lt;/remarks&gt;<br />&lt;param name=&quot;predicate&quot;&gt;A function to test whether each item in the input sequence should be included in the output.&lt;/param&gt;<br />&lt;param name=&quot;source&quot;&gt;The input sequence.&lt;/param&gt;<br />&lt;returns&gt;The result sequence.&lt;/returns&gt;<br />&lt;exception cref=&quot;T:System.ArgumentNullException&quot;&gt;Thrown when the input sequence is null.&lt;/exception&gt;</em></div>
<div class="fsdocs-tip" id="fs89">val mzSim : float</div>
<div class="fsdocs-tip" id="fs90">val intensitiesSim : float</div>
<div class="fsdocs-tip" id="fs91">val abs : value:&#39;T -&gt; &#39;T (requires member Abs)<br /><em>&lt;summary&gt;Absolute value of the given number.&lt;/summary&gt;<br />&lt;param name=&quot;value&quot;&gt;The input value.&lt;/param&gt;<br />&lt;returns&gt;The absolute value of the input.&lt;/returns&gt;</em></div>
<div class="fsdocs-tip" id="fs92">val comp1 : {| Plot: obj |}</div>
<div class="fsdocs-tip" id="fs93">anonymous record field Plot: obj</div>
<div class="fsdocs-tip" id="fs94">val comp2 : {| Plot: obj |}</div>
<div class="fsdocs-tip" id="fs95">val klDiv : p:seq&lt;float&gt; -&gt; q:seq&lt;float&gt; -&gt; float<br /><em>&#160;Calculates the Kullback-Leibler divergence Dkl(p||q) from q (theory, model, description, or approximation of p) <br />&#160;to p (the &quot;true&quot; distribution of data, observations, or a ___ ___ precisely measured).</em></div>
<div class="fsdocs-tip" id="fs96">val p : seq&lt;float&gt;</div>
<div class="fsdocs-tip" id="fs97">val q : seq&lt;float&gt;</div>
<div class="fsdocs-tip" id="fs98">val fold2 : folder:(&#39;State -&gt; &#39;T1 -&gt; &#39;T2 -&gt; &#39;State) -&gt; state:&#39;State -&gt; source1:seq&lt;&#39;T1&gt; -&gt; source2:seq&lt;&#39;T2&gt; -&gt; &#39;State<br /><em>&lt;summary&gt;Applies a function to corresponding elements of two collections, threading an accumulator argument
 through the computation.&lt;/summary&gt;<br />&lt;remarks&gt; The two sequences need not have equal lengths:
 when one sequence is exhausted any remaining elements in the other sequence are ignored.
 If the input function is &lt;c&gt;f&lt;/c&gt; and the elements are &lt;c&gt;i0...iN&lt;/c&gt; and &lt;c&gt;j0...jN&lt;/c&gt;
 then computes &lt;c&gt;f (... (f s i0 j0)...) iN jN&lt;/c&gt;.&lt;/remarks&gt;<br />&lt;param name=&quot;folder&quot;&gt;The function to update the state given the input elements.&lt;/param&gt;<br />&lt;param name=&quot;state&quot;&gt;The initial state.&lt;/param&gt;<br />&lt;param name=&quot;source1&quot;&gt;The first input sequence.&lt;/param&gt;<br />&lt;param name=&quot;source2&quot;&gt;The second input sequence.&lt;/param&gt;<br />&lt;returns&gt;The final state value.&lt;/returns&gt;<br />&lt;exception cref=&quot;T:System.ArgumentNullException&quot;&gt;Thrown when the either of the input sequences is null.&lt;/exception&gt;</em></div>
<div class="fsdocs-tip" id="fs99">val acc : float</div>
<div class="fsdocs-tip" id="fs100">val p : float</div>
<div class="fsdocs-tip" id="fs101">val q : float</div>
<div class="fsdocs-tip" id="fs102">namespace System</div>
<div class="fsdocs-tip" id="fs103">type Math =
  static member Abs : value: decimal -&gt; decimal + 6 overloads
  static member Acos : d: float -&gt; float
  static member Acosh : d: float -&gt; float
  static member Asin : d: float -&gt; float
  static member Asinh : d: float -&gt; float
  static member Atan : d: float -&gt; float
  static member Atan2 : y: float * x: float -&gt; float
  static member Atanh : d: float -&gt; float
  static member BigMul : a: int * b: int -&gt; int64 + 2 overloads
  static member BitDecrement : x: float -&gt; float
  ...<br /><em>&lt;summary&gt;Provides constants and static methods for trigonometric, logarithmic, and other common mathematical functions.&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs104">System.Math.Log(d: float) : float<br />System.Math.Log(a: float, newBase: float) : float</div>
<div class="fsdocs-tip" id="fs105">val compareIsotopicDistributions&#39; : measured:ExtractedIsoPattern -&gt; simulated:SimulatedIsoPattern -&gt; {| KLDiv: float; Plot: &#39;a |}</div>
<div class="fsdocs-tip" id="fs106">val klDiv : float</div>
<div class="fsdocs-tip" id="fs107">val lableEfficiency : obj</div>
<div class="fsdocs-tip" id="fs108">val comparison : seq&lt;obj&gt;</div>
<div class="fsdocs-tip" id="fs109">val lableEfficiency : float</div>
<div class="fsdocs-tip" id="fs110">val sim : {| Charge: int; LableEfficiency: float; PeptideSequence: string; SimPattern: (float * float) list |}</div>
<div class="fsdocs-tip" id="fs111">val comp : {| KLDiv: float; Plot: obj |}</div>
<div class="fsdocs-tip" id="fs112">val bestFit : obj</div>
<div class="fsdocs-tip" id="fs113">val x : obj</div>
<div class="fsdocs-tip" id="fs114">val lableEfficiency2 : obj</div>
<div class="fsdocs-tip" id="fs115">val comparison2 : seq&lt;obj&gt;</div>
<div class="fsdocs-tip" id="fs116">val bestFit2 : obj</div>
<div class="fsdocs-tip" id="fs117">val calcKL : peptideSequence:string -&gt; charge:int -&gt; lableEfficiency:float -&gt; float</div>
<div class="fsdocs-tip" id="fs118">val peptideSequence : string</div>
<div class="fsdocs-tip" id="fs119">val measured : {| Charge: int; Pattern: seq&lt;float * float&gt;; PeptideSequence: PeptideIon |}</div>
<div class="fsdocs-tip" id="fs120">anonymous record field KLDiv: float</div>
<div class="fsdocs-tip" id="fs121">val est1 : obj</div>
<div class="fsdocs-tip" id="fs122">val est2 : obj</div>
<div class="fsdocs-tip" id="fs123">val highIntensityPeptides : obj</div>
<div class="fsdocs-tip" id="fs124">val exists : predicate:(char -&gt; bool) -&gt; str:string -&gt; bool<br /><em>&lt;summary&gt;Tests if any character of the string satisfies the given predicate.&lt;/summary&gt;<br />&lt;param name=&quot;predicate&quot;&gt;The function to test each character of the string.&lt;/param&gt;<br />&lt;param name=&quot;str&quot;&gt;The input string.&lt;/param&gt;<br />&lt;returns&gt;True if any character returns true for the predicate and false otherwise.&lt;/returns&gt;</em></div>
<div class="fsdocs-tip" id="fs125">val not : value:bool -&gt; bool<br /><em>&lt;summary&gt;Negate a logical value. Not True equals False and not False equals True&lt;/summary&gt;<br />&lt;param name=&quot;value&quot;&gt;The value to negate.&lt;/param&gt;<br />&lt;returns&gt;The result of the negation.&lt;/returns&gt;</em></div>
<div class="fsdocs-tip" id="fs126">val estimates : seq&lt;obj&gt;</div>
<div class="fsdocs-tip" id="fs127">val choose : chooser:(&#39;T -&gt; &#39;U option) -&gt; source:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;U&gt;<br /><em>&lt;summary&gt;Applies the given function to each element of the list. Return
 the list comprised of the results &quot;x&quot; for each element where
 the function returns Some(x).&lt;/summary&gt;<br />&lt;remarks&gt;The returned sequence may be passed between threads safely. However, 
 individual IEnumerator values generated from the returned sequence should not
 be accessed concurrently.&lt;/remarks&gt;<br />&lt;param name=&quot;chooser&quot;&gt;A function to transform items of type T into options of type U.&lt;/param&gt;<br />&lt;param name=&quot;source&quot;&gt;The input sequence of type T.&lt;/param&gt;<br />&lt;returns&gt;The result sequence.&lt;/returns&gt;<br />&lt;exception cref=&quot;T:System.ArgumentNullException&quot;&gt;Thrown when the input sequence is null.&lt;/exception&gt;</em></div>
<div class="fsdocs-tip" id="fs128">val id : x:&#39;T -&gt; &#39;T<br /><em>&lt;summary&gt;The identity function&lt;/summary&gt;<br />&lt;param name=&quot;x&quot;&gt;The input value.&lt;/param&gt;<br />&lt;returns&gt;The same value.&lt;/returns&gt;</em></div>

    </div>

    <!-- BEGIN SEARCH BOX: this adds support for the search box -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/JavaScript-autoComplete/1.0.4/auto-complete.css" />
    <script type="text/javascript">var fsdocs_search_baseurl = '/BIO-BTE-06-L-7/'</script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.8/lunr.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/JavaScript-autoComplete/1.0.4/auto-complete.min.js"></script>
    <script type="text/javascript" src="/BIO-BTE-06-L-7/content/fsdocs-search.js"></script>
    <!-- END SEARCH BOX: this adds support for the search box -->
</body>

</html>